(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[511],{8131:function(e,t,s){Promise.resolve().then(s.bind(s,7357))},7357:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var a=s(7821),r=s(8078),n=s(4233),l=s(168),i=s(5343),c=s(9556),o=s(8196),d=s(3175);let u=(0,d.Z)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),m=(0,d.Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var x=s(9513),h=s(2044);function p(e){let{property:t,onClose:s,onConfirm:n}=e,[l,i]=(0,r.useState)(4.5),[c,o]=(0,r.useState)(25),[d,u]=(0,r.useState)(!1),m=(()=>{let e=l/100/12,s=12*c,a=t.remainingBalance*t.quantity;return 0===e?a/s:e*Math.pow(1+e,s)*a/(Math.pow(1+e,s)-1)})(),x=t.monthlyPayment*t.quantity-m,p=t.currentValue*t.quantity*.02,f=async()=>{u(!0);try{await n(t.id,l,c),s()}catch(e){console.error("Erreur lors du refinancement:",e),u(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-gradient-to-br from-neutral-900 to-neutral-950 rounded-2xl p-8 max-w-2xl w-full shadow-2xl border-2 border-indigo-500/30",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-3xl font-bold mb-2 text-neutral-100",children:"\uD83C\uDFE6 Refinancement"}),(0,a.jsxs)("p",{className:"text-neutral-400",children:[t.name," (\xd7",t.quantity,")"]})]}),(0,a.jsxs)("div",{className:"bg-neutral-800/50 rounded-lg p-4 space-y-2",children:[(0,a.jsx)("h4",{className:"font-semibold text-neutral-200 mb-3",children:"\uD83D\uDCCA Hypoth\xe8que actuelle"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-neutral-400",children:"Solde restant"}),(0,a.jsx)("p",{className:"font-semibold text-white",children:(0,h.l)(t.remainingBalance*t.quantity)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-neutral-400",children:"Taux actuel"}),(0,a.jsxs)("p",{className:"font-semibold text-white",children:[t.interestRate.toFixed(2),"%"]})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("p",{className:"text-neutral-400",children:"Paiement mensuel actuel"}),(0,a.jsx)("p",{className:"font-semibold text-red-400",children:(0,h.l)(t.monthlyPayment*t.quantity)})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:["Nouveau taux d'int\xe9r\xeat: ",l.toFixed(2),"%"]}),(0,a.jsx)("input",{type:"range",min:"2",max:"8",step:"0.25",value:l,onChange:e=>i(parseFloat(e.target.value)),className:"w-full"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-neutral-400 mt-1",children:[(0,a.jsx)("span",{children:"2%"}),(0,a.jsx)("span",{children:"8%"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:["Nouvelle p\xe9riode: ",c," ans"]}),(0,a.jsx)("input",{type:"range",min:"15",max:"30",step:"5",value:c,onChange:e=>o(parseInt(e.target.value)),className:"w-full"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-neutral-400 mt-1",children:[(0,a.jsx)("span",{children:"15 ans"}),(0,a.jsx)("span",{children:"30 ans"})]})]})]}),(0,a.jsxs)("div",{className:"bg-emerald-900/20 border border-emerald-700/30 rounded-lg p-4 space-y-3",children:[(0,a.jsx)("h4",{className:"font-semibold text-emerald-200",children:"\uD83D\uDCB0 Aper\xe7u du nouveau pr\xeat"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-neutral-300",children:"Nouveau paiement mensuel"}),(0,a.jsx)("span",{className:"font-semibold text-white",children:(0,h.l)(m)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-neutral-300",children:"\xc9conomie mensuelle"}),(0,a.jsxs)("span",{className:"font-semibold ".concat(x>0?"text-emerald-400":"text-red-400"),children:[x>0?"+":"",(0,h.l)(x)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-neutral-300",children:"Frais de refinancement (2%)"}),(0,a.jsx)("span",{className:"font-semibold text-amber-400",children:(0,h.l)(p)})]}),x>0&&(0,a.jsx)("div",{className:"pt-2 border-t border-emerald-700/30",children:(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{className:"text-neutral-400",children:"Rentabilis\xe9 en"}),(0,a.jsxs)("span",{className:"text-neutral-300",children:[Math.ceil(p/x)," mois"]})]})})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:s,disabled:d,className:"flex-1 px-6 py-3 rounded-lg bg-neutral-700 hover:bg-neutral-600 disabled:opacity-50 text-white font-bold transition-colors",children:"Annuler"}),(0,a.jsx)("button",{onClick:f,disabled:d||x<=0,className:"flex-1 px-6 py-3 rounded-lg bg-emerald-600 hover:bg-emerald-500 disabled:bg-neutral-700 disabled:cursor-not-allowed text-white font-bold transition-colors",children:d?"Traitement...":"Refinancer (".concat((0,h.l)(p),")")})]}),x<=0&&(0,a.jsx)("p",{className:"text-xs text-amber-400 text-center",children:"⚠️ Le nouveau taux ne vous fait pas \xe9conomiser d'argent. Essayez un taux plus bas."})]})})})}function f(e){let{property:t,onClose:s,onConfirm:n}=e,[l,i]=(0,r.useState)(1),[c,o]=(0,r.useState)(!1),d=t.currentValue*l,u=t.remainingBalance*l,m=d-u,x=t.purchasePrice*l,p=d-x,f=x>0?p/x*100:0,b=async()=>{o(!0);try{await n(t.id,l),s()}catch(e){console.error("Erreur lors de la vente:",e),o(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-gradient-to-br from-neutral-900 to-neutral-950 rounded-2xl p-8 max-w-2xl w-full shadow-2xl border-2 border-amber-500/30",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-3xl font-bold mb-2 text-neutral-100",children:"\uD83C\uDFE0 Vendre la propri\xe9t\xe9"}),(0,a.jsxs)("p",{className:"text-neutral-400",children:[t.name,", ",t.city]})]}),t.imageUrl&&(0,a.jsx)("div",{className:"aspect-video w-full bg-neutral-800 rounded-lg overflow-hidden",children:(0,a.jsx)("img",{src:t.imageUrl,alt:t.name,className:"w-full h-full object-cover"})}),t.quantity>1&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:["Quantit\xe9 \xe0 vendre: ",l," sur ",t.quantity]}),(0,a.jsx)("input",{type:"range",min:"1",max:t.quantity,value:l,onChange:e=>i(parseInt(e.target.value)),className:"w-full"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-neutral-400 mt-1",children:[(0,a.jsx)("span",{children:"1"}),(0,a.jsx)("span",{children:t.quantity})]})]}),(0,a.jsxs)("div",{className:"bg-neutral-800/50 rounded-lg p-4 space-y-3",children:[(0,a.jsx)("h4",{className:"font-semibold text-neutral-200 mb-3",children:"\uD83D\uDCCA D\xe9tails de la vente"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-neutral-400",children:"Prix d'achat original"}),(0,a.jsx)("span",{className:"text-neutral-200",children:(0,h.l)(x)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-neutral-400",children:"Valeur actuelle"}),(0,a.jsx)("span",{className:"text-white font-semibold",children:(0,h.l)(d)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-neutral-400",children:"Hypoth\xe8que \xe0 rembourser"}),(0,a.jsxs)("span",{className:"text-red-400",children:["-",(0,h.l)(u)]})]}),(0,a.jsx)("div",{className:"pt-2 border-t border-neutral-700",children:(0,a.jsxs)("div",{className:"flex justify-between font-bold",children:[(0,a.jsx)("span",{className:"text-neutral-200",children:"Montant net re\xe7u"}),(0,a.jsx)("span",{className:m>=0?"text-emerald-400":"text-red-400",children:(0,h.l)(m)})]})})]})]}),(0,a.jsxs)("div",{className:"rounded-lg p-4 border ".concat(p>=0?"bg-emerald-900/20 border-emerald-700/30":"bg-red-900/20 border-red-700/30"),children:[(0,a.jsx)("h4",{className:"font-semibold mb-3 ".concat(p>=0?"text-emerald-200":"text-red-200"),children:"\uD83D\uDCB0 R\xe9sultat de l'investissement"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-neutral-300",children:p>=0?"Plus-value totale":"Perte totale"}),(0,a.jsxs)("span",{className:"font-bold text-lg ".concat(p>=0?"text-emerald-400":"text-red-400"),children:[p>=0?"+":"",(0,h.l)(p)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-neutral-400",children:"Rendement"}),(0,a.jsxs)("span",{className:"font-semibold ".concat(f>=0?"text-emerald-400":"text-red-400"),children:[f>=0?"+":"",f.toFixed(1),"%"]})]})]})]}),m<0&&(0,a.jsxs)("div",{className:"bg-red-900/30 border border-red-700/50 rounded-lg p-4 text-red-300 text-sm",children:["⚠️ ",(0,a.jsx)("strong",{children:"Attention :"})," Le prix de vente ne couvre pas l'hypoth\xe8que restante. Vous devrez payer ",(0,h.l)(Math.abs(m))," de votre poche pour compl\xe9ter la transaction."]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:s,disabled:c,className:"flex-1 px-6 py-3 rounded-lg bg-neutral-700 hover:bg-neutral-600 disabled:opacity-50 text-white font-bold transition-colors",children:"Annuler"}),(0,a.jsx)("button",{onClick:b,disabled:c,className:"flex-1 px-6 py-3 rounded-lg bg-amber-600 hover:bg-amber-500 disabled:bg-neutral-700 disabled:cursor-not-allowed text-white font-bold transition-colors",children:c?"Traitement...":"Vendre (".concat((0,h.l)(d),")")})]}),(0,a.jsx)("p",{className:"text-xs text-neutral-400 text-center",children:"Cette action est irr\xe9versible. Les fonds seront cr\xe9dit\xe9s \xe0 votre compte imm\xe9diatement."})]})})})}function b(){let e=(0,l.useSearchParams)(),[t,s]=(0,r.useState)([]),[d,b]=(0,r.useState)(null),[j,g]=(0,r.useState)(!0),[N,v]=(0,r.useState)(null),[y,w]=(0,r.useState)(""),[C,k]=(0,r.useState)(""),[S,P]=(0,r.useState)(!1),[T,A]=(0,r.useState)(null),[D,E]=(0,r.useState)(null);(0,r.useEffect)(()=>{let t=localStorage.getItem("hm-session");if(t)try{let e=JSON.parse(t);e.gameId&&w(e.gameId),e.playerId&&k(e.playerId)}catch(e){}"true"===e.get("success")&&(P(!0),setTimeout(()=>P(!1),5e3))},[e]);let V=(0,r.useCallback)(async()=>{if(y&&C)try{g(!0);let e=await (0,x.SC)("/api/games/".concat(y,"/players/").concat(C,"/portfolio"));b(e.totals);let t=await (0,x.SC)("/api/games/".concat(y,"/properties/holdings/").concat(C));s(t.holdings),v(null)}catch(e){v(e instanceof Error?e.message:"Impossible de charger vos propri\xe9t\xe9s")}finally{g(!1)}},[y,C]);(0,r.useEffect)(()=>{V()},[V]);let I=async(e,t,s)=>{if(y)try{await (0,x.SC)("/api/games/".concat(y,"/properties/").concat(e,"/refinance"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({newRate:t/100,newTermYears:s})}),await V(),A(null)}catch(e){throw v(e instanceof Error?e.message:"\xc9chec du refinancement"),e}},q=async e=>{if(y)try{await (0,x.SC)("/api/games/".concat(y,"/properties/").concat(e,"/sell"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),await V(),E(null)}catch(e){throw v(e instanceof Error?e.message:"\xc9chec de la vente"),e}};return(0,a.jsxs)("main",{className:"min-h-screen p-4 bg-neutral-950",children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(n.default,{href:"/immobilier",className:"flex items-center gap-2 text-neutral-400 hover:text-neutral-200 transition-colors",children:[(0,a.jsx)(i.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Retour \xe0 l'agence"})]}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-neutral-100",children:"\uD83C\uDFE2 Mon Parc Immobilier"})]}),S&&(0,a.jsx)("div",{className:"bg-emerald-900/20 border border-emerald-500/50 rounded-lg p-4 text-emerald-300 animate-pulse",children:"✅ Op\xe9ration r\xe9ussie !"}),j&&!d&&(0,a.jsx)("div",{className:"text-center py-12 text-neutral-400",children:"Chargement de votre portefeuille immobilier..."}),N&&(0,a.jsx)("div",{className:"bg-red-900/20 border border-red-500/50 rounded-lg p-4 text-red-300",children:N}),!j&&!N&&0===t.length&&(0,a.jsxs)("div",{className:"text-center py-12 space-y-4",children:[(0,a.jsx)(c.Z,{className:"w-16 h-16 text-neutral-600 mx-auto"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-neutral-300",children:"Aucune propri\xe9t\xe9 pour le moment"}),(0,a.jsx)("p",{className:"text-neutral-400",children:"Commencez par rechercher et acheter votre premier immeuble !"}),(0,a.jsx)(n.default,{href:"/immobilier",className:"inline-block px-6 py-3 rounded-lg bg-emerald-600 hover:bg-emerald-500 text-white font-semibold transition-colors",children:"Explorer les immeubles disponibles"})]}),!j&&!N&&d&&t.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-emerald-900/30 to-emerald-950/50 border border-emerald-700/30 rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)(c.Z,{className:"w-6 h-6 text-emerald-400"}),(0,a.jsx)("h3",{className:"text-sm font-medium text-neutral-300",children:"Valeur totale"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold text-emerald-400",children:(0,h.l)(d.totalValue)}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400 mt-1",children:[d.holdingsCount," propri\xe9t\xe9(s)"]})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-red-900/30 to-red-950/50 border border-red-700/30 rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)(o.Z,{className:"w-6 h-6 text-red-400"}),(0,a.jsx)("h3",{className:"text-sm font-medium text-neutral-300",children:"Dette totale"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-400",children:(0,h.l)(d.totalDebt)}),(0,a.jsx)("p",{className:"text-xs text-neutral-400 mt-1",children:"Solde hypoth\xe9caire"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-indigo-900/30 to-indigo-950/50 border border-indigo-700/30 rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)(u,{className:"w-6 h-6 text-indigo-400"}),(0,a.jsx)("h3",{className:"text-sm font-medium text-neutral-300",children:"\xc9quit\xe9 nette"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold text-indigo-400",children:(0,h.l)(d.totalValue-d.totalDebt)}),(0,a.jsx)("p",{className:"text-xs text-neutral-400 mt-1",children:d.totalValue>0?"".concat(((d.totalValue-d.totalDebt)/d.totalValue*100).toFixed(1),"% du total"):"0%"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-amber-900/30 to-amber-950/50 border border-amber-700/30 rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)(m,{className:"w-6 h-6 text-amber-400"}),(0,a.jsx)("h3",{className:"text-sm font-medium text-neutral-300",children:"Cashflow mensuel"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold ".concat(d.monthlyNet>=0?"text-emerald-400":"text-red-400"),children:(0,h.l)(d.monthlyNet)}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400 mt-1",children:["Revenus: ",(0,h.l)(d.monthlyRent)]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-100",children:"\uD83D\uDCCB Vos propri\xe9t\xe9s"}),(0,a.jsx)("div",{className:"grid lg:grid-cols-2 gap-4",children:t.map(e=>{let t=e.currentValue-e.mortgageDebt,s=e.currentValue>0?t/e.currentValue*100:0,r=52*e.weeklyPayment/12,n=52*e.currentRent/12,l=(e.template.taxes+e.template.insurance+e.template.maintenance)/12,i=n-r-l;return(0,a.jsxs)("div",{className:"border border-neutral-800 rounded-lg bg-neutral-900 overflow-hidden",children:[e.template.imageUrl&&(0,a.jsx)("div",{className:"aspect-video w-full bg-neutral-800",children:(0,a.jsx)("img",{src:e.template.imageUrl,alt:e.template.name,className:"w-full h-full object-cover"})}),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex justify-between items-start mb-1",children:(0,a.jsx)("h3",{className:"font-bold text-lg text-neutral-100",children:e.template.name})}),(0,a.jsx)("p",{className:"text-sm text-neutral-400",children:e.template.city}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500 mt-1",children:["Achet\xe9 le ",new Date(e.createdAt).toLocaleDateString("fr-CA")]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,a.jsxs)("div",{className:"bg-neutral-800/50 rounded p-3",children:[(0,a.jsx)("p",{className:"text-neutral-400",children:"Valeur actuelle"}),(0,a.jsx)("p",{className:"font-semibold text-neutral-100",children:(0,h.l)(e.currentValue)})]}),(0,a.jsxs)("div",{className:"bg-neutral-800/50 rounded p-3",children:[(0,a.jsx)("p",{className:"text-neutral-400",children:"Hypoth\xe8que restante"}),(0,a.jsx)("p",{className:"font-semibold text-red-400",children:(0,h.l)(e.mortgageDebt)})]}),(0,a.jsxs)("div",{className:"bg-neutral-800/50 rounded p-3",children:[(0,a.jsx)("p",{className:"text-neutral-400",children:"\xc9quit\xe9"}),(0,a.jsx)("p",{className:"font-semibold text-indigo-400",children:(0,h.l)(t)}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500",children:[s.toFixed(1),"%"]})]}),(0,a.jsxs)("div",{className:"bg-neutral-800/50 rounded p-3",children:[(0,a.jsx)("p",{className:"text-neutral-400",children:"Paiement mensuel"}),(0,a.jsx)("p",{className:"font-semibold text-amber-400",children:(0,h.l)(r)})]})]}),(0,a.jsxs)("div",{className:"bg-emerald-900/20 border border-emerald-700/30 rounded p-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-neutral-300",children:"Cashflow mensuel"}),(0,a.jsx)("span",{className:"font-bold ".concat(i>=0?"text-emerald-400":"text-red-400"),children:(0,h.l)(i)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-neutral-400",children:[(0,a.jsxs)("span",{children:["Loyer: ",(0,h.l)(n)]}),(0,a.jsxs)("span",{children:["D\xe9penses: ",(0,h.l)(r+l)]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>A(e),className:"flex-1 px-4 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-semibold transition-colors",children:"Refinancer"}),(0,a.jsx)("button",{onClick:()=>E(e),className:"flex-1 px-4 py-2 rounded bg-amber-600 hover:bg-amber-500 text-white text-sm font-semibold transition-colors",children:"Vendre"})]})]})]},e.id)})})]}),(0,a.jsx)("div",{className:"text-center pt-6",children:(0,a.jsx)(n.default,{href:"/immobilier",className:"inline-block px-6 py-3 rounded-lg bg-emerald-600 hover:bg-emerald-500 text-white font-semibold transition-colors",children:"+ Ajouter une propri\xe9t\xe9"})})]})]}),T&&(0,a.jsx)(p,{property:{id:T.id,name:T.template.name,currentValue:T.currentValue,remainingBalance:T.mortgageDebt,monthlyPayment:52*T.weeklyPayment/12,interestRate:100*T.mortgageRate,quantity:1},onClose:()=>A(null),onConfirm:I}),D&&(0,a.jsx)(f,{property:{id:D.id,name:D.template.name,city:D.template.city,currentValue:D.currentValue,purchasePrice:D.purchasePrice,remainingBalance:D.mortgageDebt,quantity:1,imageUrl:D.template.imageUrl},onClose:()=>E(null),onConfirm:(e,t)=>q(e)})]})}function j(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen text-neutral-400",children:"Chargement..."}),children:(0,a.jsx)(b,{})})}},9513:function(e,t,s){"use strict";s.d(t,{MS:function(){return o},SC:function(){return x},Sg:function(){return c}});var a=s(5050);let r="https://server-jeux-millionnaire.onrender.com",n=!!window.Capacitor,l=/localhost:3000$/.test(window.location.host),i="1"===a.env.NEXT_PUBLIC_FORCE_ABS,c=n||i||!l?r:"";console.log("[API] ABS_BACKEND:",r),console.log("[API] isCapacitor:",n),console.log("[API] isLocalDev:",l),console.log("[API] forceAbs:",i),console.log("[API] API_BASE:",c);class o extends Error{constructor(e,t){super(t),this.name="ApiError",this.status=e,Object.setPrototypeOf(this,o.prototype)}}let d=null,u="HM_TOKEN";async function m(){try{var e;if(d)return d;let t=await fetch("".concat(c,"/api/auth/csrf"),{credentials:"include"});if(!t.ok)return null;let s=await t.json();return d=null!==(e=null==s?void 0:s.csrf)&&void 0!==e?e:null}catch(e){return null}}async function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(t.method||"GET").toUpperCase(),a={...t.headers};if(console.log("[API] ".concat(s," ").concat(c).concat(e)),["POST","PUT","PATCH","DELETE"].includes(s)){let e=await m();e&&(a["x-csrf-token"]=e)}let r=function(){try{return window.localStorage.getItem(u)}catch(e){return null}}();r&&(a.Authorization="Bearer ".concat(r));let n=function(){try{let e=window.localStorage.getItem("hm-session");if(!e)return null;return JSON.parse(e).playerId||null}catch(e){return null}}();n&&(a["X-Player-ID"]=n);try{let s=await fetch("".concat(c).concat(e),{credentials:"include",...t,headers:a});if(console.log("[API] Response ".concat(s.status," ").concat(s.statusText)),401===s.status)try{if(r){let s=await fetch("".concat(c,"/api/auth/refresh"),{credentials:"include",headers:{Authorization:"Bearer ".concat(r)}});if(s.ok){let r=await s.json().catch(()=>({}));if(null==r?void 0:r.token){try{window.localStorage.setItem(u,r.token)}catch(e){}a.Authorization="Bearer ".concat(r.token)}let n=await fetch("".concat(c).concat(e),{credentials:"include",...t,headers:a});if(!n.ok)throw new o(n.status,n.statusText);if(204===n.status)return;return await n.json()}}}catch(e){}if(!s.ok)try{if((s.headers.get("content-type")||"").includes("application/json")){let e=await s.json(),t=e&&(e.error||e.message)?String(e.error||e.message):"Erreur ".concat(s.status);throw new o(s.status,t)}{let e=(await s.text()||"").trim(),t=e.length?e:s.statusText?"".concat(s.status," ").concat(s.statusText):"Erreur ".concat(s.status);throw new o(s.status,t)}}catch(t){let e=s.statusText?"".concat(s.status," ").concat(s.statusText):"Erreur ".concat(s.status);if(t instanceof o)throw t;throw new o(s.status,e)}if(204===s.status)return;return await s.json()}catch(e){throw console.error("[API] Fetch error:",e),new o(0,"Erreur r\xe9seau: ".concat(e.message||"Failed to fetch"))}}},2044:function(e,t,s){"use strict";function a(e){let t=Number(e);return isFinite(t)?"$".concat(Math.round(t).toLocaleString()):"$0"}function r(e){return 52*Number(e||0)/12}s.d(t,{P:function(){return r},l:function(){return a}})},3175:function(e,t,s){"use strict";s.d(t,{Z:function(){return u}});var a=s(8078);let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),l=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:r=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:d="",children:u,iconNode:m,...x}=e;return(0,a.createElement)("svg",{ref:t,...o,width:r,height:r,stroke:s,strokeWidth:l?24*Number(n)/Number(r):n,className:i("lucide",d),...!u&&!c(x)&&{"aria-hidden":"true"},...x},[...m.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let s=(0,a.forwardRef)((s,n)=>{let{className:c,...o}=s;return(0,a.createElement)(d,{ref:n,iconNode:t,className:i("lucide-".concat(r(l(e))),"lucide-".concat(e),c),...o})});return s.displayName=l(e),s}},5343:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(3175).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9556:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(3175).Z)("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]])},8196:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(3175).Z)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},168:function(e,t,s){"use strict";var a=s(7462);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},5050:function(e,t,s){"use strict";var a,r;e.exports=(null==(a=s.g.process)?void 0:a.env)&&"object"==typeof(null==(r=s.g.process)?void 0:r.env)?s.g.process:s(9295)},9295:function(e){!function(){var t={229:function(e){var t,s,a,r=e.exports={};function n(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===n||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:n}catch(e){t=n}try{s="function"==typeof clearTimeout?clearTimeout:l}catch(e){s=l}}();var c=[],o=!1,d=-1;function u(){o&&a&&(o=!1,a.length?c=a.concat(c):d=-1,c.length&&m())}function m(){if(!o){var e=i(u);o=!0;for(var t=c.length;t;){for(a=c,c=[];++d<t;)a&&a[d].run();d=-1,t=c.length}a=null,o=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===l||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function x(e,t){this.fun=e,this.array=t}function h(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];c.push(new x(e,t)),1!==c.length||o||i(m)},x.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=h,r.addListener=h,r.once=h,r.off=h,r.removeListener=h,r.removeAllListeners=h,r.emit=h,r.prependListener=h,r.prependOnceListener=h,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},s={};function a(e){var r=s[e];if(void 0!==r)return r.exports;var n=s[e]={exports:{}},l=!0;try{t[e](n,n.exports,a),l=!1}finally{l&&delete s[e]}return n.exports}a.ab="//";var r=a(229);e.exports=r}()}},function(e){e.O(0,[233,115,205,744],function(){return e(e.s=8131)}),_N_E=e.O()}]);