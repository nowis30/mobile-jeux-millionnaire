(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[680],{6223:function(e,t,r){Promise.resolve().then(r.bind(r,5926))},5926:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var s=r(7821),n=r(8078),a=r(168),o=r(2044),c=r(9513);function i(){let e=(0,a.useRouter)(),[t,r]=(0,n.useState)(null),[i,l]=(0,n.useState)(null),[u,d]=(0,n.useState)([]),[h,f]=(0,n.useState)(!0),[m,x]=(0,n.useState)(null);(0,n.useEffect)(()=>{let t=localStorage.getItem("hm-session");if(t)try{let s=JSON.parse(t);s.gameId&&s.playerId?(r(s.gameId),l(s.playerId)):e.push("/")}catch(t){e.push("/")}else e.push("/")},[e]),(0,n.useEffect)(()=>{t&&e();async function e(){try{f(!0);let e=await (0,c.SC)("/api/properties/templates?gameId=".concat(t));d(e.templates)}catch(e){console.error("Erreur chargement immeubles:",e),x(e.message||"Impossible de charger les propri\xe9t\xe9s")}finally{f(!1)}}},[t]);let p=t=>{e.push("/immobilier/hypotheques?id=".concat(t))};return h?(0,s.jsx)("div",{className:"min-h-screen bg-surface-0 text-surface-on flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-xl",children:"Chargement des opportunit\xe9s..."})}):(0,s.jsxs)("div",{className:"min-h-screen bg-surface-0 text-surface-on pb-20",children:[(0,s.jsx)("div",{className:"sticky top-0 z-10 bg-surface-1/95 backdrop-blur border-b border-surface-divider p-4 shadow-elev-1",children:(0,s.jsxs)("div",{className:"max-w-5xl mx-auto flex items-center justify-between",children:[(0,s.jsx)("button",{onClick:()=>e.push("/"),className:"ui-btn ui-btn--neutral text-sm",children:"← Retour"}),(0,s.jsx)("h1",{className:"text-xl font-bold text-center bg-gradient-to-r from-blue-400 to-cyan-300 bg-clip-text text-transparent",children:"Agence Immobili\xe8re"}),(0,s.jsx)("button",{onClick:()=>e.push("/immobilier/parc"),className:"ui-btn ui-btn--info text-sm font-bold",children:"Mon Parc"})]})}),(0,s.jsxs)("div",{className:"max-w-5xl mx-auto p-4",children:[m&&(0,s.jsx)("div",{className:"mb-6 p-4 border border-rose-700/60 bg-rose-900/30 rounded-card text-rose-100",children:m}),(0,s.jsx)("div",{className:"mb-6 text-center",children:(0,s.jsxs)("p",{className:"text-slate-400",children:["Investissez dans l'immobilier pour g\xe9n\xe9rer des revenus passifs.",(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"text-xs opacity-70",children:"Les prix incluent le terrain et le b\xe2timent."})]})}),0===u.length?(0,s.jsxs)("div",{className:"text-center py-12 ui-card",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"\uD83C\uDFD9️"}),(0,s.jsx)("h3",{className:"text-xl font-bold mb-2",children:"Aucune propri\xe9t\xe9 disponible"}),(0,s.jsx)("p",{className:"text-surface-muted",children:"Le march\xe9 est actuellement vide ou vous avez tout achet\xe9 !"})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(e=>(0,s.jsxs)("div",{onClick:()=>p(e.id),className:"group ui-card overflow-hidden hover:border-brand-sky/60 transition-all cursor-pointer hover:shadow-elev-2 hover:-translate-y-1",children:[(0,s.jsxs)("div",{className:"relative h-48 bg-surface-3 overflow-hidden",children:[e.imageUrl?(0,s.jsx)("img",{src:e.imageUrl,alt:e.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",onError:e=>{e.target.src="https://placehold.co/600x400/1e293b/cbd5e1?text=Immeuble"}}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center text-surface-muted",children:(0,s.jsx)("span",{className:"text-4xl",children:"\uD83C\uDFE2"})}),(0,s.jsxs)("div",{className:"absolute top-2 right-2 bg-black/70 backdrop-blur px-2 py-1 rounded text-xs font-bold text-white border border-white/10",children:[e.units," logement",e.units>1?"s":""]}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4 pt-12",children:(0,s.jsx)("div",{className:"text-white font-bold text-lg truncate shadow-black drop-shadow-md",children:(0,o.l)(e.price)})})]}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h3",{className:"font-bold text-lg mb-1 text-surface-on group-hover:text-brand-sky transition-colors truncate",children:e.name}),(0,s.jsx)("div",{className:"flex items-center text-xs text-surface-muted mb-3",children:(0,s.jsxs)("span",{className:"truncate",children:["\uD83D\uDCCD ",e.address,", ",e.city]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm mb-4",children:[(0,s.jsxs)("div",{className:"bg-surface-1 p-2 rounded border border-surface-divider",children:[(0,s.jsx)("div",{className:"text-surface-muted text-xs",children:"Revenus bruts"}),(0,s.jsxs)("div",{className:"font-semibold text-emerald-400",children:[(0,o.l)(e.baseRent*e.units),"/mois"]})]}),(0,s.jsxs)("div",{className:"bg-surface-1 p-2 rounded border border-surface-divider",children:[(0,s.jsx)("div",{className:"text-surface-muted text-xs",children:"Rentabilit\xe9"}),(0,s.jsxs)("div",{className:"font-semibold text-brand-sky",children:[(e.baseRent*e.units*12/e.price*100).toFixed(1),"%"]})]})]}),(0,s.jsx)("button",{className:"ui-btn ui-btn--info w-full text-sm",children:"Voir le dossier"})]})]},e.id))})]})]})}},9513:function(e,t,r){"use strict";r.d(t,{MS:function(){return l},SC:function(){return f},Sg:function(){return i}});var s=r(5050);let n="https://server-jeux-millionnaire.onrender.com",a=!!window.Capacitor,o=/localhost:3000$/.test(window.location.host),c="1"===s.env.NEXT_PUBLIC_FORCE_ABS,i=a||c||!o?n:"";console.log("[API] ABS_BACKEND:",n),console.log("[API] isCapacitor:",a),console.log("[API] isLocalDev:",o),console.log("[API] forceAbs:",c),console.log("[API] API_BASE:",i);class l extends Error{constructor(e,t){super(t),this.name="ApiError",this.status=e,Object.setPrototypeOf(this,l.prototype)}}let u=null,d="HM_TOKEN";async function h(){try{var e;if(u)return u;let t=await fetch("".concat(i,"/api/auth/csrf"),{credentials:"include"});if(!t.ok)return null;let r=await t.json();return u=null!==(e=null==r?void 0:r.csrf)&&void 0!==e?e:null}catch(e){return null}}async function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t.method||"GET").toUpperCase(),s={...t.headers};if(console.log("[API] ".concat(r," ").concat(i).concat(e)),["POST","PUT","PATCH","DELETE"].includes(r)){let e=await h();e&&(s["x-csrf-token"]=e)}let n=function(){try{return window.localStorage.getItem(d)}catch(e){return null}}();n&&(s.Authorization="Bearer ".concat(n));let a=function(){try{let e=window.localStorage.getItem("hm-session");if(!e)return null;return JSON.parse(e).playerId||null}catch(e){return null}}();a&&(s["X-Player-ID"]=a);try{let r=await fetch("".concat(i).concat(e),{credentials:"include",...t,headers:s});if(console.log("[API] Response ".concat(r.status," ").concat(r.statusText)),401===r.status)try{if(n){let r=await fetch("".concat(i,"/api/auth/refresh"),{credentials:"include",headers:{Authorization:"Bearer ".concat(n)}});if(r.ok){let n=await r.json().catch(()=>({}));if(null==n?void 0:n.token){try{window.localStorage.setItem(d,n.token)}catch(e){}s.Authorization="Bearer ".concat(n.token)}let a=await fetch("".concat(i).concat(e),{credentials:"include",...t,headers:s});if(!a.ok)throw new l(a.status,a.statusText);if(204===a.status)return;return await a.json()}}}catch(e){}if(!r.ok)try{if((r.headers.get("content-type")||"").includes("application/json")){let e=await r.json(),t=e&&(e.error||e.message)?String(e.error||e.message):"Erreur ".concat(r.status);throw new l(r.status,t)}{let e=(await r.text()||"").trim(),t=e.length?e:r.statusText?"".concat(r.status," ").concat(r.statusText):"Erreur ".concat(r.status);throw new l(r.status,t)}}catch(t){let e=r.statusText?"".concat(r.status," ").concat(r.statusText):"Erreur ".concat(r.status);if(t instanceof l)throw t;throw new l(r.status,e)}if(204===r.status)return;return await r.json()}catch(e){throw console.error("[API] Fetch error:",e),new l(0,"Erreur r\xe9seau: ".concat(e.message||"Failed to fetch"))}}},2044:function(e,t,r){"use strict";function s(e){let t=Number(e);return isFinite(t)?"$".concat(Math.round(t).toLocaleString()):"$0"}function n(e){return 52*Number(e||0)/12}r.d(t,{P:function(){return n},l:function(){return s}})},168:function(e,t,r){"use strict";var s=r(7462);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},5050:function(e,t,r){"use strict";var s,n;e.exports=(null==(s=r.g.process)?void 0:s.env)&&"object"==typeof(null==(n=r.g.process)?void 0:n.env)?r.g.process:r(9295)},9295:function(e){!function(){var t={229:function(e){var t,r,s,n=e.exports={};function a(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var i=[],l=!1,u=-1;function d(){l&&s&&(l=!1,s.length?i=s.concat(i):u=-1,i.length&&h())}function h(){if(!l){var e=c(d);l=!0;for(var t=i.length;t;){for(s=i,i=[];++u<t;)s&&s[u].run();u=-1,t=i.length}s=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];i.push(new f(e,t)),1!==i.length||l||c(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},r={};function s(e){var n=r[e];if(void 0!==n)return n.exports;var a=r[e]={exports:{}},o=!0;try{t[e](a,a.exports,s),o=!1}finally{o&&delete r[e]}return a.exports}s.ab="//";var n=s(229);e.exports=n}()}},function(e){e.O(0,[115,205,744],function(){return e(e.s=6223)}),_N_E=e.O()}]);