(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[126],{4958:function(e,t,r){Promise.resolve().then(r.bind(r,4483))},4483:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var n=r(7821),s=r(8078),l=r(4233),a=r(5343),o=r(9513),i=r(2044);function c(){let[e,t]=(0,s.useState)([]),[r,c]=(0,s.useState)(!0),[u,d]=(0,s.useState)(null),[h,m]=(0,s.useState)(""),[f,x]=(0,s.useState)(""),[p,g]=(0,s.useState)("tous");(0,s.useEffect)(()=>{let e=localStorage.getItem("hm-session");e&&m(e)},[]);let v=(0,s.useCallback)(async()=>{try{var e;c(!0);let r=h?"?gameId=".concat(encodeURIComponent(h)):"",n=await (0,o.SC)("/api/properties/templates".concat(r));t(null!==(e=n.templates)&&void 0!==e?e:[]),d(null)}catch(e){d(e instanceof Error?e.message:"Impossible de charger les immeubles")}finally{c(!1)}},[h]);(0,s.useEffect)(()=>{v()},[v]);let b=e.filter(e=>{let t=e.name.toLowerCase().includes(f.toLowerCase())||e.city.toLowerCase().includes(f.toLowerCase());if("tous"===p)return t;let r=Number(e.units||0);return"6plex"===p?t&&6===r:"tour50"===p?t&&50===r:"tour100"===p?t&&100===r:"gratte-ciel"===p?t&&r>=400:"village"===p?t&&r>=800:t}),w=e=>{let t=Number(null!=e?e:0);return t>=800?"VILLAGE_FUTURISTE":t>=400?"GRATTE_CIEL":t>=50?"TOUR":6===t?"SIXPLEX":3===t?"TRIPLEX":2===t?"DUPLEX":"MAISON"};return(0,n.jsx)("main",{className:"min-h-screen p-4 bg-neutral-950",children:(0,n.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)(l.default,{href:"/immobilier/menu",className:"flex items-center gap-2 text-neutral-400 hover:text-neutral-200 transition-colors",children:[(0,n.jsx)(a.Z,{className:"w-5 h-5"}),(0,n.jsx)("span",{children:"Retour au menu"})]}),(0,n.jsx)("h1",{className:"text-3xl font-bold text-neutral-100",children:"\uD83D\uDD0D Recherche d'immeubles"})]}),(0,n.jsxs)("div",{className:"bg-neutral-900/50 border border-neutral-800 rounded-lg p-4 space-y-4",children:[(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Recherche"}),(0,n.jsx)("input",{type:"text",value:f,onChange:e=>x(e.target.value),placeholder:"Nom ou ville...",className:"w-full px-4 py-2 rounded bg-neutral-900 border border-neutral-700 text-neutral-100 placeholder-neutral-500 focus:border-emerald-500 focus:outline-none"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-neutral-300 mb-2",children:"Type d'immeuble"}),(0,n.jsxs)("select",{value:p,onChange:e=>g(e.target.value),className:"w-full px-4 py-2 rounded bg-neutral-900 border border-neutral-700 text-neutral-100 focus:border-emerald-500 focus:outline-none",children:[(0,n.jsxs)("option",{value:"tous",children:["Tous (",e.length,")"]}),(0,n.jsxs)("option",{value:"6plex",children:["6-plex (",e.filter(e=>6===Number(e.units||0)).length,")"]}),(0,n.jsxs)("option",{value:"tour50",children:["Tours 50 log. (",e.filter(e=>50===Number(e.units||0)).length,")"]}),(0,n.jsxs)("option",{value:"tour100",children:["Tours 100 log. (",e.filter(e=>100===Number(e.units||0)).length,")"]}),(0,n.jsxs)("option",{value:"gratte-ciel",children:["Gratte-ciel 400+ (",e.filter(e=>Number(e.units||0)>=400).length,")"]}),(0,n.jsxs)("option",{value:"village",children:["Villages futuristes 800+ (",e.filter(e=>Number(e.units||0)>=800).length,")"]})]})]})]}),(0,n.jsxs)("div",{className:"text-sm text-neutral-400",children:[b.length," immeuble(s) trouv\xe9(s)"]})]}),r&&(0,n.jsx)("div",{className:"text-center py-12 text-neutral-400",children:"Chargement des immeubles..."}),u&&(0,n.jsx)("div",{className:"bg-red-900/20 border border-red-500/50 rounded-lg p-4 text-red-300",children:u}),!r&&!u&&0===b.length&&(0,n.jsx)("div",{className:"text-center py-12 text-neutral-400",children:"Aucun immeuble ne correspond \xe0 vos crit\xe8res"}),!r&&!u&&b.length>0&&(0,n.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:b.map(e=>{var t,r,s;return(0,n.jsxs)("article",{className:"border border-neutral-800 rounded-lg bg-neutral-900 overflow-hidden hover:border-emerald-500/50 transition-all",children:[(0,n.jsx)("div",{className:"aspect-video w-full bg-neutral-800 flex items-center justify-center text-neutral-500",children:"GRATTE_CIEL"===w(e.units)?(0,n.jsx)("span",{className:"text-xs",children:"Pas de photo"}):e.imageUrl?(0,n.jsx)("img",{src:e.imageUrl,alt:e.name,className:"w-full h-full object-cover"}):(0,n.jsx)("span",{className:"text-xs",children:"Pas de photo"})}),(0,n.jsxs)("div",{className:"p-4 space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h4",{className:"font-semibold text-neutral-100",children:e.name}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-neutral-800 border border-neutral-700",children:(()=>{let t=w(e.units);return"VILLAGE_FUTURISTE"===t?"Village futuriste":"GRATTE_CIEL"===t?"Gratte‑ciel":"TOUR"===t?"Tour":"SIXPLEX"===t?"6‑plex":"TRIPLEX"===t?"Triplex":"DUPLEX"===t?"Duplex":"Maison"})()}),(0,n.jsx)("span",{className:"text-sm text-neutral-400",children:e.city})]})]}),(0,n.jsxs)("p",{className:"text-sm text-neutral-300",children:["Prix: ",(0,i.l)(e.price)]}),(0,n.jsxs)("p",{className:"text-sm text-neutral-300",children:["Loyer unitaire: ",(0,i.l)(e.baseRent)," ",e.units?"\xd7 ".concat(e.units," log."):""]}),(()=>{var t;let r=Number(null!==(t=e.units)&&void 0!==t?t:0);return r>=800?(0,n.jsx)("p",{className:"text-xs text-fuchsia-300",children:"Village futuriste \xb7 Habitat autonome \xb7 Prix fixe strat\xe9gique"}):r>=400?(0,n.jsx)("p",{className:"text-xs text-indigo-300",children:"100 \xe9tages \xb7 Centre commercial int\xe9gr\xe9 \xb7 Multiplicateur 14–16\xd7 revenus"}):null})(),(0,n.jsxs)("p",{className:"text-xs text-neutral-500",children:["Charges: taxes ",(0,i.l)(e.taxes),"/an, assurance ",(0,i.l)(e.insurance),"/an, entretien ",(0,i.l)(e.maintenance),"/an"]}),(0,n.jsxs)("p",{className:"text-xs text-neutral-500",children:["\xc9tat — Plomberie: ",null!==(t=e.plumbingState)&&void 0!==t?t:"n/a",", \xc9lectricit\xe9: ",null!==(r=e.electricityState)&&void 0!==r?r:"n/a",", Toiture: ",null!==(s=e.roofState)&&void 0!==s?s:"n/a"]}),e.description&&(0,n.jsx)("p",{className:"text-xs text-neutral-400 mt-1",children:e.description}),(0,n.jsx)("div",{className:"pt-2",children:(0,n.jsx)(l.default,{href:"/immobilier?select=".concat(e.id),className:"block w-full text-center px-4 py-2 rounded bg-emerald-600 hover:bg-emerald-500 text-white font-medium transition-colors",children:"S\xe9lectionner pour achat"})})]})]},e.id)})})]})})}},9513:function(e,t,r){"use strict";r.d(t,{MS:function(){return c},SC:function(){return m},Sg:function(){return i}});var n=r(5050);let s="https://server-jeux-millionnaire.onrender.com",l=!!window.Capacitor,a=/localhost:3000$/.test(window.location.host),o="1"===n.env.NEXT_PUBLIC_FORCE_ABS,i=l||o||!a?s:"";console.log("[API] ABS_BACKEND:",s),console.log("[API] isCapacitor:",l),console.log("[API] isLocalDev:",a),console.log("[API] forceAbs:",o),console.log("[API] API_BASE:",i);class c extends Error{constructor(e,t){super(t),this.name="ApiError",this.status=e,Object.setPrototypeOf(this,c.prototype)}}let u=null,d="HM_TOKEN";async function h(){try{var e;if(u)return u;let t=await fetch("".concat(i,"/api/auth/csrf"),{credentials:"include"});if(!t.ok)return null;let r=await t.json();return u=null!==(e=null==r?void 0:r.csrf)&&void 0!==e?e:null}catch(e){return null}}async function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t.method||"GET").toUpperCase(),n={...t.headers};if(console.log("[API] ".concat(r," ").concat(i).concat(e)),["POST","PUT","PATCH","DELETE"].includes(r)){let e=await h();e&&(n["x-csrf-token"]=e)}let s=function(){try{return window.localStorage.getItem(d)}catch(e){return null}}();s&&(n.Authorization="Bearer ".concat(s));let l=function(){try{let e=window.localStorage.getItem("hm-session");if(!e)return null;return JSON.parse(e).playerId||null}catch(e){return null}}();l&&(n["X-Player-ID"]=l);try{let r=await fetch("".concat(i).concat(e),{credentials:"include",...t,headers:n});if(console.log("[API] Response ".concat(r.status," ").concat(r.statusText)),401===r.status)try{if(s){let r=await fetch("".concat(i,"/api/auth/refresh"),{credentials:"include",headers:{Authorization:"Bearer ".concat(s)}});if(r.ok){let s=await r.json().catch(()=>({}));if(null==s?void 0:s.token){try{window.localStorage.setItem(d,s.token)}catch(e){}n.Authorization="Bearer ".concat(s.token)}let l=await fetch("".concat(i).concat(e),{credentials:"include",...t,headers:n});if(!l.ok)throw new c(l.status,l.statusText);if(204===l.status)return;return await l.json()}}}catch(e){}if(!r.ok)try{if((r.headers.get("content-type")||"").includes("application/json")){let e=await r.json(),t=e&&(e.error||e.message)?String(e.error||e.message):"Erreur ".concat(r.status);throw new c(r.status,t)}{let e=(await r.text()||"").trim(),t=e.length?e:r.statusText?"".concat(r.status," ").concat(r.statusText):"Erreur ".concat(r.status);throw new c(r.status,t)}}catch(t){let e=r.statusText?"".concat(r.status," ").concat(r.statusText):"Erreur ".concat(r.status);if(t instanceof c)throw t;throw new c(r.status,e)}if(204===r.status)return;return await r.json()}catch(e){throw console.error("[API] Fetch error:",e),new c(0,"Erreur r\xe9seau: ".concat(e.message||"Failed to fetch"))}}},2044:function(e,t,r){"use strict";function n(e){let t=Number(e);return isFinite(t)?"$".concat(Math.round(t).toLocaleString()):"$0"}function s(e){return 52*Number(e||0)/12}r.d(t,{P:function(){return s},l:function(){return n}})},3175:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var n=r(8078);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),a=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},i=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let u=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:a,className:u="",children:d,iconNode:h,...m}=e;return(0,n.createElement)("svg",{ref:t,...c,width:s,height:s,stroke:r,strokeWidth:a?24*Number(l)/Number(s):l,className:o("lucide",u),...!d&&!i(m)&&{"aria-hidden":"true"},...m},[...h.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let r=(0,n.forwardRef)((r,l)=>{let{className:i,...c}=r;return(0,n.createElement)(u,{ref:l,iconNode:t,className:o("lucide-".concat(s(a(e))),"lucide-".concat(e),i),...c})});return r.displayName=a(e),r}},5343:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(3175).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5050:function(e,t,r){"use strict";var n,s;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(s=r.g.process)?void 0:s.env)?r.g.process:r(9295)},9295:function(e){!function(){var t={229:function(e){var t,r,n,s=e.exports={};function l(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===l||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:l}catch(e){t=l}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var i=[],c=!1,u=-1;function d(){c&&n&&(c=!1,n.length?i=n.concat(i):u=-1,i.length&&h())}function h(){if(!c){var e=o(d);c=!0;for(var t=i.length;t;){for(n=i,i=[];++u<t;)n&&n[u].run();u=-1,t=i.length}n=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function f(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];i.push(new m(e,t)),1!==i.length||c||o(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=f,s.addListener=f,s.once=f,s.off=f,s.removeListener=f,s.removeAllListeners=f,s.emit=f,s.prependListener=f,s.prependOnceListener=f,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var l=r[e]={exports:{}},a=!0;try{t[e](l,l.exports,n),a=!1}finally{a&&delete r[e]}return l.exports}n.ab="//";var s=n(229);e.exports=s}()}},function(e){e.O(0,[233,115,205,744],function(){return e(e.s=4958)}),_N_E=e.O()}]);