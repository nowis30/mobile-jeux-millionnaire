(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[616],{7438:function(e,t,n){Promise.resolve().then(n.bind(n,3678))},3678:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var r=n(7821),s=n(8078),i=n(4233),a=n(6325),l=n(2705),o=n(9513),c=n(2044);function u(){let[e,t]=(0,s.useState)(null),[n,u]=(0,s.useState)(null),[d,m]=(0,s.useState)(!1),[p,h]=(0,s.useState)(!1),[x,f]=(0,s.useState)(!1),[v,g]=(0,s.useState)(0),[b,j]=(0,s.useState)(null),[N,w]=(0,s.useState)(null),[y,C]=(0,s.useState)(""),[T,D]=(0,s.useState)(1e6);(0,s.useEffect)(()=>{let e=()=>{var e,t,n,r;let s=window,i=!!s.Capacitor,a=(null===(t=s.Capacitor)||void 0===t?void 0:null===(e=t.isNativePlatform)||void 0===e?void 0:e.call(t))||!1,l=!!(null===(r=s.Capacitor)||void 0===r?void 0:null===(n=r.Plugins)||void 0===n?void 0:n.AdMob),o="Capacitor: ".concat(i," | Native: ").concat(a," | AdMob: ").concat(l);C(o),console.log("[Bonus Debug]",o),console.log("[Bonus Debug] Full Capacitor:",s.Capacitor)};e(),setTimeout(e,2e3)},[]),(0,s.useEffect)(()=>{let e=(0,l.dF)();e&&(t(e.gameId||null),u(e.playerId||null))},[]);let k=(0,s.useCallback)(async()=>{if(e&&n)try{var t;let n=await (0,o.SC)("/api/games/".concat(e,"/bonus/status"));m(!!n.available),g(Math.max(0,Number(null!==(t=n.secondsUntilAvailable)&&void 0!==t?t:0))),"number"!=typeof n.rewardAmount||Number.isNaN(n.rewardAmount)||D(n.rewardAmount),w(null)}catch(e){if((null==e?void 0:e.status)===404)return;w((null==e?void 0:e.message)||"Impossible de r\xe9cup\xe9rer la disponibilit\xe9 du bonus.")}},[e,n]);(0,s.useEffect)(()=>{k()},[k]),(0,s.useEffect)(()=>{let e=async()=>{h(await (0,a.yk)());let e=(0,a.Ie)();e>0&&g(e)};e();let t=setInterval(e,5e3);return()=>clearInterval(t)},[]),(0,s.useEffect)(()=>{if(v>0){let e=setTimeout(()=>{g(e=>Math.max(0,e-1))},1e3);return()=>clearTimeout(e)}},[v]);let S=async()=>{if(!e||!n){w("Rejoignez la partie mondiale pour d\xe9bloquer ce bonus.");return}if(!x&&!(v>0)&&d&&p){f(!0),w(null),j(null);try{var t,r;if(!await (0,a.fL)((e,t)=>{console.log("R\xe9compense AdMob gagn\xe9e: ".concat(e," ").concat(t))})){w("La pub n'a pas pu \xeatre affich\xe9e. R\xe9essayez dans quelques instants.");return}let n=await (0,o.SC)("/api/games/".concat(e,"/bonus/redeem"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),s=Number(null!==(t=null==n?void 0:n.rewardAmount)&&void 0!==t?t:T);j(s),D(s);let i=Number(null!==(r=null==n?void 0:n.secondsUntilNext)&&void 0!==r?r:0),l=(0,a.Ie)();g(Math.max(i,l)),m(!1),h(!1),k()}catch(e){(null==e?void 0:e.status)===429&&k(),console.error("Erreur lors de l'affichage de la pub:",e),w((null==e?void 0:e.message)||"Une erreur s'est produite")}finally{f(!1)}}},L=!e||!n||x||v>0||!d||!p;return(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 text-white p-4",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-8",children:(0,r.jsxs)(i.default,{href:"/",className:"text-white/80 hover:text-white transition-colors flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Retour"]})}),(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold mb-2",children:"\uD83D\uDCB0 Bonus Gratuit"}),(0,r.jsxs)("p",{className:"text-xl text-white/80",children:["Regardez une pub et gagnez ",(0,c.l)(T)," !"]})]}),(0,r.jsxs)("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl p-8 shadow-2xl border border-white/20",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsxs)("div",{className:"inline-block bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full px-8 py-4 mb-4",children:[(0,r.jsx)("div",{className:"text-sm text-white/90 uppercase tracking-wider mb-1",children:"R\xe9compense"}),(0,r.jsx)("div",{className:"text-5xl font-bold text-white",children:(0,c.l)(T)})]}),(0,r.jsx)("p",{className:"text-white/70 text-sm",children:"Regardez une publicit\xe9 de 30 secondes pour recevoir cette r\xe9compense"})]}),b&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-green-500/20 border border-green-500/50 rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-2xl mb-2",children:"\uD83C\uDF89"}),(0,r.jsxs)("div",{className:"text-lg font-semibold",children:["F\xe9licitations ! Vous avez gagn\xe9 $",b.toLocaleString()," !"]}),(0,r.jsx)("div",{className:"text-sm text-white/70 mt-2",children:"L'argent a \xe9t\xe9 ajout\xe9 \xe0 votre compte"})]}),N&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-red-500/20 border border-red-500/50 rounded-lg text-center",children:(0,r.jsx)("div",{className:"text-sm",children:N})}),(0,r.jsx)("button",{onClick:S,disabled:L,className:"\n              w-full py-4 px-6 rounded-xl font-bold text-xl\n              transition-all duration-200 shadow-lg\n              ".concat(L?"bg-gray-500 cursor-not-allowed opacity-60":"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 hover:scale-105 active:scale-95","\n            "),children:x?(0,r.jsxs)("span",{className:"flex items-center justify-center gap-3",children:[(0,r.jsxs)("svg",{className:"animate-spin h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Chargement de la publicit\xe9..."]}):e&&n?v>0?(0,r.jsxs)("span",{children:["⏱️ Disponible dans ",(e=>{if(0===e)return"";let t=Math.floor(e/60),n=e%60;return t>0?"".concat(t,"min ").concat(n,"s"):"".concat(n,"s")})(v)]}):d?p?(0,r.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCFA"}),(0,r.jsx)("span",{children:"Regarder la publicit\xe9"})]}):(0,r.jsx)("span",{children:"\uD83D\uDCFA Chargement de la pub..."}):(0,r.jsx)("span",{children:"\uD83D\uDD04 Bonus en pr\xe9paration..."}):(0,r.jsx)("span",{children:"Connexion en cours..."})}),(0,r.jsxs)("div",{className:"mt-6 space-y-3 text-sm text-white/70",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-green-400 mt-0.5",children:"✓"}),(0,r.jsx)("span",{children:"Regardez la publicit\xe9 en entier pour recevoir la r\xe9compense"})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-green-400 mt-0.5",children:"✓"}),(0,r.jsx)("span",{children:"Vous pouvez gagner un bonus toutes les 5 minutes"})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-green-400 mt-0.5",children:"✓"}),(0,r.jsx)("span",{children:"L'argent est imm\xe9diatement cr\xe9dit\xe9 sur votre compte"})]})]})]}),(0,r.jsxs)("div",{className:"mt-8 text-center text-sm text-white/50",children:[(0,r.jsx)("p",{children:"Les publicit\xe9s nous aident \xe0 maintenir le jeu gratuit pour tous"}),(0,r.jsx)("p",{className:"mt-2",children:"Merci de votre soutien ! \uD83D\uDC9C"}),y&&(0,r.jsx)("div",{className:"mt-4 p-2 bg-black/30 rounded text-xs font-mono text-left",children:y})]})]})})}},2044:function(e,t,n){"use strict";function r(e){let t=Number(e);return isFinite(t)?"$".concat(Math.round(t).toLocaleString()):"$0"}function s(e){return 52*Number(e||0)/12}n.d(t,{P:function(){return s},l:function(){return r}})},5050:function(e,t,n){"use strict";var r,s;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(s=n.g.process)?void 0:s.env)?n.g.process:n(9295)},9295:function(e){!function(){var t={229:function(e){var t,n,r,s=e.exports={};function i(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var o=[],c=!1,u=-1;function d(){c&&r&&(c=!1,r.length?o=r.concat(o):u=-1,o.length&&m())}function m(){if(!c){var e=l(d);c=!0;for(var t=o.length;t;){for(r=o,o=[];++u<t;)r&&r[u].run();u=-1,t=o.length}r=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];o.push(new p(e,t)),1!==o.length||c||l(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=h,s.addListener=h,s.once=h,s.off=h,s.removeListener=h,s.removeAllListeners=h,s.emit=h,s.prependListener=h,s.prependOnceListener=h,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var i=n[e]={exports:{}},a=!0;try{t[e](i,i.exports,r),a=!1}finally{a&&delete n[e]}return i.exports}r.ab="//";var s=r(229);e.exports=s}()}},function(e){e.O(0,[498,305,115,205,744],function(){return e(e.s=7438)}),_N_E=e.O()}]);