(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[703],{7280:function(e,t,n){Promise.resolve().then(n.bind(n,3615))},3615:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(7821),l=n(8078);function a(){let e=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let t=e.current;if(!t)return;let n=()=>{setTimeout(()=>{let e=localStorage.getItem("HM_TOKEN");e&&t.contentWindow?(console.log("[DragIframeWrapper] Envoi du token \xe0 l'iframe:",e.substring(0,20)+"..."),t.contentWindow.postMessage({type:"AUTH_TOKEN",token:e,source:"parent"},window.location.origin)):console.warn("[DragIframeWrapper] Pas de token HM_TOKEN trouv\xe9 dans localStorage")},100)};return t.addEventListener("load",n),()=>{t.removeEventListener("load",n)}},[]),(0,r.jsx)("iframe",{ref:e,title:"Drag Shift Duel",src:"/drag/iframe.html",className:"w-full h-full bg-black",allow:"fullscreen"})}function i(e){let{onNativeDetected:t}=e,[n,a]=(0,l.useState)(!1),[i,o]=(0,l.useState)(!1);(0,l.useEffect)(()=>{var e;let n=window.Capacitor,r=!!(null==n?void 0:null===(e=n.Plugins)||void 0===e?void 0:e.DragLauncher),l=!!(null==n?void 0:n.isNative)||!!(null==n?void 0:n.isNativePlatform),s=r||l;a(s),t&&t(s),s&&!i&&(o(!0),setTimeout(()=>{u()},300))},[i,t]);let s=()=>{try{let e=window.localStorage.getItem("HM_TOKEN")||window.localStorage.getItem("hm-token")||void 0,t=window.localStorage.getItem("hm-session")||void 0;if(!e&&!t)return;return{token:e,sessionJson:t}}catch(e){return}},u=async()=>{try{var e;let t=window.Capacitor,n=null==t?void 0:null===(e=t.Plugins)||void 0===e?void 0:e.DragLauncher;if(!n)return;let r=s()||{};"function"==typeof n.race?await n.race(r):"function"==typeof n.open&&await n.open(r)}catch(e){console.warn("DragLauncher natif indisponible:",e)}};return n?(0,r.jsx)("div",{className:"px-2 pb-2",children:(0,r.jsx)("button",{onClick:u,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white text-sm py-2 rounded",children:"\uD83C\uDFC1 Lancer une course native (avec pub)"})}):null}function o(){let[e,t]=(0,l.useState)(!1);return(0,r.jsxs)("main",{className:"w-full h-[calc(100vh-4rem)] flex flex-col",children:[!e&&(0,r.jsxs)("div",{className:"p-2 text-xs text-neutral-400",children:[(0,r.jsx)("p",{children:"Miniâ€‘jeu int\xe9gr\xe9. Si l'affichage ne se charge pas, essayez la version plein \xe9cran ou rafra\xeechissez."}),(0,r.jsx)("p",{children:"Les gains et meilleurs temps seront synchronis\xe9s avec votre session Millionnaire (impl\xe9mentation prochaine)."})]}),(0,r.jsx)(i,{onNativeDetected:t}),!e&&(0,r.jsx)("div",{className:"flex-1 border-t border-neutral-800",children:(0,r.jsx)(a,{})}),e&&(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center text-neutral-400 text-sm",children:(0,r.jsx)("p",{children:"\uD83C\uDFC1 Version native Android - Appuyez sur le bouton pour lancer une course"})})]})}}},function(e){e.O(0,[115,205,744],function(){return e(e.s=7280)}),_N_E=e.O()}]);