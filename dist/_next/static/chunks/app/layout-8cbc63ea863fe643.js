(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{4530:function(e,t,r){Promise.resolve().then(r.bind(r,5743)),Promise.resolve().then(r.bind(r,1519)),Promise.resolve().then(r.bind(r,9404)),Promise.resolve().then(r.bind(r,3845)),Promise.resolve().then(r.bind(r,9458)),Promise.resolve().then(r.bind(r,1449)),Promise.resolve().then(r.bind(r,1666)),Promise.resolve().then(r.t.bind(r,3812,23)),Promise.resolve().then(r.t.bind(r,7498,23)),Promise.resolve().then(r.bind(r,2209)),Promise.resolve().then(r.bind(r,3178))},5743:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var n=r(8078),i=r(6325);function l(){return(0,n.useEffect)(()=>{(0,i.YY)().catch(e=>{console.error("[AdInitializer] Failed to initialize ads:",e)})},[]),null}},1519:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var n=r(7821),i=r(8078);let l="hm-music-enabled",a="hm-music-volume";function o(){let e=(0,i.useRef)(null),[t,r]=(0,i.useState)(!0),[o,s]=(0,i.useState)(.35),[u,c]=(0,i.useState)(!1),[d,m]=(0,i.useState)(!1),h=(0,i.useRef)(!1),f=(0,i.useRef)(null),b=(0,i.useRef)(null);(0,i.useEffect)(()=>{try{let e=localStorage.getItem(l),t=localStorage.getItem(a);if(null!=e&&r("1"===e),null!=t){let e=Number(t);Number.isNaN(e)||s(Math.min(1,Math.max(0,e)))}}catch(e){}},[]),(0,i.useEffect)(()=>{let t=!1,r=["/audio/theme.mp3","/audio/Theme.mp3","/audio/theme.MP3"],n=async i=>{if(t||i>=r.length){m(!0);return}let l=r[i];try{let e=await fetch(l,{method:"HEAD",cache:"no-store"});if(!e.ok)throw Error(String(e.status))}catch(e){return n(i+1)}let a=new Audio(l);a.loop=!0,a.preload="auto",a.volume=o,e.current=a;let s=()=>{t||(c(!0),m(!1))},u=()=>{t||(a.pause(),a.removeEventListener("canplay",s),a.removeEventListener("error",u),n(i+1))};a.addEventListener("canplay",s),a.addEventListener("error",u)};return n(0),()=>{t=!0;let r=e.current;r&&(r.pause(),r.removeAttribute("src"),e.current=null),v()}},[]),(0,i.useEffect)(()=>{e.current&&(e.current.volume=o);try{localStorage.setItem(a,String(o))}catch(e){}},[o]);let p=()=>{if(!b.current&&t&&!h.current)try{let e=new(window.AudioContext||window.webkitAudioContext);f.current=e;let t=e.createOscillator(),r=e.createGain();t.type="sine",t.frequency.value=220,r.gain.value=Math.min(1,Math.max(0,.3*o)),t.connect(r).connect(e.destination),"suspended"===e.state&&e.resume().catch(()=>{}),t.start(),b.current=t}catch(e){}},v=()=>{if(b.current){try{b.current.stop()}catch(e){}b.current.disconnect(),b.current=null}if(f.current){try{f.current.close()}catch(e){}f.current=null}};return(0,i.useEffect)(()=>{if(!e.current)return;if(!t||h.current){e.current.pause(),v();return}let r=()=>{if(!h.current){if(f.current&&"suspended"===f.current.state&&f.current.resume().catch(()=>{}),d){p(),n();return}e.current&&e.current.play().catch(()=>{})}},n=()=>{window.removeEventListener("touchend",r),window.removeEventListener("pointerdown",r),window.removeEventListener("click",r),window.removeEventListener("keydown",r)};return window.addEventListener("touchend",r,{once:!0}),window.addEventListener("pointerdown",r,{once:!0}),window.addEventListener("click",r,{once:!0}),window.addEventListener("keydown",r,{once:!0}),setTimeout(()=>{r()},350),n},[t,u,d]),(0,i.useEffect)(()=>{let r=()=>{let r=e.current;document.hidden?(r&&r.pause(),v()):t&&!h.current&&(d?(f.current&&"suspended"===f.current.state&&f.current.resume().catch(()=>{}),p()):r&&r.play().catch(()=>{}))};return document.addEventListener("visibilitychange",r),()=>document.removeEventListener("visibilitychange",r)},[t,d]),(0,i.useEffect)(()=>{let r=()=>{h.current=!0;let t=e.current;t&&t.pause(),v()},n=()=>{h.current=!1;let r=e.current;t&&!document.hidden&&(d?(f.current&&"suspended"===f.current.state&&f.current.resume().catch(()=>{}),p()):r&&r.play().catch(()=>{}))},i=()=>{h.current=!1;let r=e.current;f.current&&"suspended"===f.current.state&&f.current.resume().catch(()=>{}),t&&(d?p():r&&r.play().catch(()=>{}))};return window.addEventListener("hm-music/pause",r),window.addEventListener("hm-music/resume",n),window.addEventListener("hm-music/play-now",i),()=>{window.removeEventListener("hm-music/pause",r),window.removeEventListener("hm-music/resume",n),window.removeEventListener("hm-music/play-now",i)}},[t]),(0,n.jsxs)("div",{className:"fixed z-40 bottom-24 right-4 md:right-6 flex items-center gap-2 bg-neutral-900/80 backdrop-blur border border-neutral-800 rounded-full px-3 py-1.5",children:[(0,n.jsx)("button",{"aria-label":t?"Couper la musique":"Activer la musique",onClick:()=>{let n=!t;r(n);try{localStorage.setItem(l,n?"1":"0")}catch(e){}let i=e.current;i&&(n?(h.current=!1,d?p():i.play().catch(()=>{})):(i.pause(),v()))},className:"px-2 py-1 text-xs rounded bg-neutral-800 hover:bg-neutral-700 border border-neutral-700",children:t?"Musique: ON":"Musique: OFF"}),(0,n.jsx)("input",{"aria-label":"Volume musique",type:"range",min:0,max:1,step:.01,value:o,onChange:e=>s(parseFloat(e.target.value)),className:"w-28 accent-indigo-400"}),d&&(0,n.jsx)("span",{className:"text-[10px] text-amber-300",title:"Placez /public/audio/theme.mp3 pour musique compl\xe8te",children:"(fallback tonal)"})]})}},9404:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r(7821),i=r(8078),l=r(6325);function a(){let[e,t]=(0,i.useState)(!1),[r,a]=(0,i.useState)(!0);return((0,i.useEffect)(()=>{try{localStorage.getItem("hm-ad-consent")||t(!0)}catch(e){}a(!1)},[]),r||!e)?null:(0,n.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-neutral-900 border-t border-neutral-700 p-4 shadow-lg z-50 md:bottom-0",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,n.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[(0,n.jsxs)("div",{className:"text-sm text-neutral-300",children:[(0,n.jsx)("p",{className:"font-medium mb-1",children:"Cookies et publicit\xe9s"}),(0,n.jsxs)("p",{className:"text-xs text-neutral-400",children:["Nous utilisons des cookies et affichons des publicit\xe9s pour am\xe9liorer votre exp\xe9rience. En acceptant, vous consentez \xe0 l'utilisation de cookies publicitaires."," ",(0,n.jsx)("a",{href:"/confidentialite/",className:"text-emerald-400 hover:underline",children:"Politique de confidentialit\xe9"})]})]}),(0,n.jsxs)("div",{className:"flex gap-2 shrink-0",children:[(0,n.jsx)("button",{onClick:()=>{try{localStorage.setItem("hm-ad-consent","refused"),localStorage.setItem("hm-ad-consent-date",new Date().toISOString())}catch(e){}t(!1)},className:"px-4 py-2 rounded bg-neutral-800 hover:bg-neutral-700 text-sm text-neutral-300",children:"Refuser"}),(0,n.jsx)("button",{onClick:()=>{try{localStorage.setItem("hm-ad-consent","accepted"),localStorage.setItem("hm-ad-consent-date",new Date().toISOString())}catch(e){}t(!1),(0,l.YY)().catch(e=>{console.error("[ConsentBanner] initializeAds failed after accept:",e)})},className:"px-4 py-2 rounded bg-emerald-600 hover:bg-emerald-500 text-sm text-white font-medium",children:"Accepter"})]})]})})})}},3845:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r(8078),i=r(9513);async function l(e){for(let t of["/api/health","/"])try{let r="".concat(e).concat(t);if((await function(e,t){let r=new AbortController,n=setTimeout(()=>r.abort("timeout"),8e3);return(async()=>{try{return await e}finally{clearTimeout(n)}})()}(fetch(r,{method:"GET",credentials:"include"}),0)).ok)return!0}catch(e){}return!1}function a(){return(0,n.useEffect)(()=>{let e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.Sg,t=!1,r=async r=>{if(!t&&(!("onLine"in navigator)||navigator.onLine))try{let t=await l(e);console.log("[KeepAlive] ping (".concat(r,") -> ").concat(t?"OK":"fail"))}catch(e){console.warn("[KeepAlive] ping error",e)}};r("mount");let n=()=>{"visible"===document.visibilityState&&r("visible")},a=()=>r("focus");document.addEventListener("visibilitychange",n),window.addEventListener("focus",a);let o=window.setInterval(()=>r("interval"),54e4);return()=>{t=!0,clearInterval(o),document.removeEventListener("visibilitychange",n),window.removeEventListener("focus",a)}}();return()=>e()},[]),null}},9458:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r(7821),i=r(4233),l=r(168),a=r(8078);async function o(e){let t=window,r=(null==t?void 0:t.Capacitor)||(null==t?void 0:t.capacitor)||(null==t?void 0:t.CAPACITOR),n=(null==r?void 0:r.Plugins)||(null==r?void 0:r.plugins)||(null==r?void 0:r.pluginsRef),i=(null==n?void 0:n.ImmobilierLauncher)||(null==n?void 0:n.immobilierLauncher);try{if(null==i?void 0:i.open)return await i.open(e?{startUrl:e}:{}),!0}catch(e){console.warn("openImmobilier: \xe9chec d'ouverture native",e)}return!1}let s=[{href:"/",label:"Accueil"},{href:"/immobilier",label:"Immobilier"},{href:"/bourse",label:"Bourse"},{href:"/portefeuille",label:"Portefeuille"},{href:r(7588).M,label:"Drag"},{href:"/quiz",label:"Quiz"},{href:"/pari",label:"Pari"}];function u(){let e=(0,l.usePathname)(),t=(0,l.useRouter)(),[r,u]=(0,a.useState)(!1),c=(0,a.useCallback)(async e=>{var t,r,n,i;let l=window;try{let n=null==l?void 0:null===(r=l.Capacitor)||void 0===r?void 0:null===(t=r.Plugins)||void 0===t?void 0:t.Browser;if(null==n?void 0:n.open){await n.open({url:e});return}}catch(e){}try{let t=null==l?void 0:null===(i=l.Capacitor)||void 0===i?void 0:null===(n=i.Plugins)||void 0===n?void 0:n.App;if(null==t?void 0:t.openUrl){await t.openUrl({url:e});return}}catch(e){}try{window.open(e,"_blank","noopener,noreferrer")}catch(t){window.location.href=e}},[]),d=(0,a.useCallback)(async e=>{if(u(!1),!("/immobilier"===e.href&&function(){var e;let t=window,r=(null==t?void 0:t.Capacitor)||(null==t?void 0:t.capacitor)||(null==t?void 0:t.CAPACITOR),n=(null==r?void 0:null===(e=r.getPlatform)||void 0===e?void 0:e.call(r))||(null==r?void 0:r.platform);return!!r&&("android"===n||"ios"===n||"webview"===n)}()&&await o("https://client-jeux-millionnaire.vercel.app/immobilier"))){if(e.external){c(e.href);return}t.push(e.href)}},[t,c]);return(0,n.jsxs)("div",{className:"md:hidden",children:[(0,n.jsxs)("button",{type:"button","aria-label":"Ouvrir le menu",onClick:()=>u(!0),className:"fixed z-40 bottom-20 right-4 w-16 h-16 rounded-full bg-neutral-900 border border-neutral-800 shadow-xl text-white flex flex-col items-center justify-center gap-1 active:scale-95 transition-transform",children:[(0,n.jsx)("span",{className:"block w-8 h-[3px] bg-white rounded"}),(0,n.jsx)("span",{className:"block w-8 h-[3px] bg-white rounded"}),(0,n.jsx)("span",{className:"block w-8 h-[3px] bg-white rounded"}),(0,n.jsx)("span",{className:"text-[10px] font-medium tracking-wide",children:"Menu"})]}),(0,n.jsxs)("div",{className:"fixed z-40 bottom-4 right-4 flex gap-3",children:[(0,n.jsxs)(i.default,{href:"/quiz",className:["relative group flex flex-col items-center justify-center w-16 h-16 rounded-xl shadow-lg border",(null==e?void 0:e.startsWith("/quiz"))?"bg-sky-600 border-sky-500 text-white":"bg-sky-700 border-sky-600 text-white hover:bg-sky-600"].join(" "),prefetch:!1,children:[(0,n.jsx)("span",{className:"text-sm font-semibold",children:"Quiz"}),(0,n.jsx)("span",{className:"absolute -top-2 -right-2 bg-white text-sky-700 text-[10px] px-1.5 py-0.5 rounded-full shadow group-hover:scale-110 transition-transform",children:"â˜…"})]}),(0,n.jsx)(i.default,{href:"/pari",className:["flex flex-col items-center justify-center w-16 h-16 rounded-xl shadow-lg border",(null==e?void 0:e.startsWith("/pari"))?"bg-amber-600 border-amber-500 text-white":"bg-amber-700 border-amber-600 text-white hover:bg-amber-600"].join(" "),prefetch:!1,children:(0,n.jsx)("span",{className:"text-sm font-semibold",children:"Pari"})})]}),r&&(0,n.jsx)("div",{className:"fixed inset-0 z-50 bg-black/70",onClick:()=>u(!1),children:(0,n.jsxs)("nav",{className:"absolute inset-x-0 bottom-0 bg-neutral-900 border-t border-neutral-800 rounded-t-2xl p-5 pt-4 max-h-[80vh] overflow-y-auto",onClick:e=>e.stopPropagation(),role:"dialog","aria-modal":"true",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("div",{className:"text-sm font-semibold tracking-wide text-neutral-300",children:"Navigation"}),(0,n.jsx)("button",{type:"button","aria-label":"Fermer le menu",onClick:()=>u(!1),className:"px-3 py-1.5 rounded-md bg-neutral-800 border border-neutral-700 text-neutral-200 text-sm hover:bg-neutral-700",children:"Fermer"})]}),(0,n.jsx)("ul",{className:"grid grid-cols-2 gap-2 text-[15px]",children:s.map(t=>{let r="/"===t.href?"/":t.href.replace(/\/$/,""),i=!t.external&&(e===r||(null==e?void 0:e.startsWith("".concat(r,"/"))));return(0,n.jsx)("li",{children:(0,n.jsx)("button",{type:"button",onClick:()=>{d(t)},className:["block w-full rounded-lg px-4 py-3 border font-medium",i?"bg-neutral-800 border-neutral-700 text-white":"bg-neutral-900 border-neutral-800 text-neutral-300 hover:bg-neutral-800/70"].join(" "),children:t.label})},t.href)})}),(0,n.jsxs)("div",{className:"mt-5 grid grid-cols-2 gap-3",children:[(0,n.jsx)("button",{type:"button",onClick:()=>d({href:"/quiz",label:"Quiz"}),className:["block w-full text-center rounded-lg px-4 py-3 font-semibold shadow",(null==e?void 0:e.startsWith("/quiz"))?"bg-sky-600 text-white":"bg-sky-700 text-white hover:bg-sky-600"].join(" "),children:"D\xe9marrer Quiz"}),(0,n.jsx)("button",{type:"button",onClick:()=>d({href:"/pari",label:"Pari"}),className:["block w-full text-center rounded-lg px-4 py-3 font-semibold shadow",(null==e?void 0:e.startsWith("/pari"))?"bg-amber-600 text-white":"bg-amber-700 text-white hover:bg-amber-600"].join(" "),children:"Lancer Pari"})]})]})})]})}},1449:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var n=r(8078),i=r(4328),l=r(2705),a=r(9513);function o(){let e=(0,n.useRef)(null),[t,r]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let t=!0;return(async()=>{try{let o=await (0,a.SC)("/api/auth/me").catch(()=>null);if(!t||!(null==o?void 0:o.email))return;let{gameId:s,playerId:u,nickname:c}=(0,l.dF)()||{gameId:"",playerId:"",nickname:""};if(!s||!u){var n;let e=await (0,a.SC)("/api/games").catch(()=>null),t=null==e?void 0:null===(n=e.games)||void 0===n?void 0:n[0];if(t){let e=await (0,a.SC)("/api/games/".concat(t.id,"/join"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).catch(()=>null);(null==e?void 0:e.playerId)&&(s=t.id,u=e.playerId,c=o.email,(0,l.Aj)({gameId:s,playerId:u,nickname:c}))}}if(!s)return;let d=(0,i.io)(a.Sg,{path:"/socket.io",transports:["websocket"],query:{gameId:s,nickname:o.email},withCredentials:!0});e.current=d,r(!0),d.emit("join-game",s,o.email)}catch(e){}})(),()=>{t=!1;try{var r;null===(r=e.current)||void 0===r||r.close()}catch(e){}e.current=null}},[]),null}},1666:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var n=r(7821),i=r(8078),l=r(168),a=r(9513);function o(){let e=(0,l.usePathname)(),[t,r]=(0,i.useState)(""),[o,s]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{(async()=>{try{let e=await (0,a.SC)("/api/auth/me");r(e.email),s(!!e.isAdmin)}catch(e){}})()},[]),"/login"===e||"/forgot"===e||"/reset"===e)?null:(0,n.jsx)("div",{className:"text-sm text-neutral-300 flex items-center gap-2",children:t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"inline-flex h-2 w-2 rounded-full bg-emerald-500"}),(0,n.jsx)("span",{className:"font-medium",title:t,children:t}),o&&(0,n.jsx)("span",{className:"px-2 py-0.5 text-xs rounded bg-amber-600/30 border border-amber-600/60",children:"Admin"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"inline-flex h-2 w-2 rounded-full bg-neutral-500"}),(0,n.jsx)("a",{href:"/login",className:"underline",children:"Se connecter"})]})})}},7588:function(e,t,r){"use strict";r.d(t,{M:function(){return n}});let n="/drag"},168:function(e,t,r){"use strict";var n=r(7462);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},2209:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return i}});let n=r(1905);function i(e){let{reason:t,children:r}=e;if("undefined"==typeof window)throw new n.BailoutToCSRError(t);return r}},3178:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return l}});let n=r(7821),i=r(4116);function l(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let r=(0,i.getExpectedRequestStore)("next/dynamic css"),l=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files.filter(e=>e.endsWith(".css"));l.push(...t)}}return 0===l.length?null:(0,n.jsx)(n.Fragment,{children:l.map(e=>(0,n.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:r.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},3812:function(){}},function(e){e.O(0,[836,233,640,320,115,205,744],function(){return e(e.s=4530)}),_N_E=e.O()}]);