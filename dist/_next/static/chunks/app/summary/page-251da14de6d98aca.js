(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[129],{3572:function(t,e,n){Promise.resolve().then(n.bind(n,4586))},4586:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return c}});var r=n(7821),s=n(8078),a=n(9513),o=n(2044);function c(){let[t,e]=(0,s.useState)(""),[n,c]=(0,s.useState)(null),[i,l]=(0,s.useState)(null);return(0,s.useEffect)(()=>{(async()=>{try{if(!t){var n;let t=await (0,a.SC)("/api/games"),r=null===(n=t.games)||void 0===n?void 0:n[0];(null==r?void 0:r.id)&&e(r.id)}}catch(t){}})()},[t]),(0,s.useEffect)(()=>{t&&(async()=>{try{let e=await (0,a.SC)("/api/games/".concat(t,"/summary"));c(e)}catch(t){l(t instanceof Error?t.message:"Impossible de charger le r\xe9sum\xe9")}})()},[t]),(0,r.jsxs)("main",{className:"space-y-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"R\xe9sum\xe9 de la partie"}),i&&(0,r.jsx)("p",{className:"text-sm text-red-400",children:i}),n&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("p",{className:"text-sm text-neutral-300",children:["Statut: ",n.status]}),(0,r.jsxs)("div",{className:"border border-neutral-800 rounded bg-neutral-900 p-3",children:[(0,r.jsx)("h3",{className:"font-semibold",children:"Vainqueur"}),n.winner?(0,r.jsxs)("p",{className:"text-sm",children:[n.winner.nickname," â€” ",(0,o.l)(n.winner.netWorth)]}):(0,r.jsx)("p",{className:"text-sm text-neutral-400",children:"Aucun vainqueur."})]}),(0,r.jsx)("div",{className:"border border-neutral-800 rounded bg-neutral-900",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"text-left",children:[(0,r.jsx)("th",{className:"p-2",children:"#"}),(0,r.jsx)("th",{className:"p-2",children:"Joueur"}),(0,r.jsx)("th",{className:"p-2",children:"Valeur nette"})]})}),(0,r.jsx)("tbody",{children:n.leaderboard.map((t,e)=>(0,r.jsxs)("tr",{className:"border-t border-neutral-800",children:[(0,r.jsx)("td",{className:"p-2",children:e+1}),(0,r.jsx)("td",{className:"p-2",children:t.nickname}),(0,r.jsx)("td",{className:"p-2",children:(0,o.l)(t.netWorth)})]},t.playerId))})]})})]})]})}},9513:function(t,e,n){"use strict";n.d(e,{MS:function(){return l},SC:function(){return f},Sg:function(){return i}});var r=n(5050);let s="https://server-jeux-millionnaire.onrender.com",a=!!window.Capacitor,o=/localhost:3000$/.test(window.location.host),c="1"===r.env.NEXT_PUBLIC_FORCE_ABS,i=a||c||!o?s:"";console.log("[API] ABS_BACKEND:",s),console.log("[API] isCapacitor:",a),console.log("[API] isLocalDev:",o),console.log("[API] forceAbs:",c),console.log("[API] API_BASE:",i);class l extends Error{constructor(t,e){super(e),this.name="ApiError",this.status=t,Object.setPrototypeOf(this,l.prototype)}}let u=null,h="HM_TOKEN";async function d(){try{var t;if(u)return u;let e=await fetch("".concat(i,"/api/auth/csrf"),{credentials:"include"});if(!e.ok)return null;let n=await e.json();return u=null!==(t=null==n?void 0:n.csrf)&&void 0!==t?t:null}catch(t){return null}}async function f(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e.method||"GET").toUpperCase(),r={...e.headers};if(console.log("[API] ".concat(n," ").concat(i).concat(t)),["POST","PUT","PATCH","DELETE"].includes(n)){let t=await d();t&&(r["x-csrf-token"]=t)}let s=function(){try{return window.localStorage.getItem(h)}catch(t){return null}}();s&&(r.Authorization="Bearer ".concat(s));let a=function(){try{let t=window.localStorage.getItem("hm-session");if(!t)return null;return JSON.parse(t).playerId||null}catch(t){return null}}();a&&(r["X-Player-ID"]=a);try{let n=await fetch("".concat(i).concat(t),{credentials:"include",...e,headers:r});if(console.log("[API] Response ".concat(n.status," ").concat(n.statusText)),401===n.status)try{if(s){let n=await fetch("".concat(i,"/api/auth/refresh"),{credentials:"include",headers:{Authorization:"Bearer ".concat(s)}});if(n.ok){let s=await n.json().catch(()=>({}));if(null==s?void 0:s.token){try{window.localStorage.setItem(h,s.token)}catch(t){}r.Authorization="Bearer ".concat(s.token)}let a=await fetch("".concat(i).concat(t),{credentials:"include",...e,headers:r});if(!a.ok)throw new l(a.status,a.statusText);if(204===a.status)return;return await a.json()}}}catch(t){}if(!n.ok)try{if((n.headers.get("content-type")||"").includes("application/json")){let t=await n.json(),e=t&&(t.error||t.message)?String(t.error||t.message):"Erreur ".concat(n.status);throw new l(n.status,e)}{let t=(await n.text()||"").trim(),e=t.length?t:n.statusText?"".concat(n.status," ").concat(n.statusText):"Erreur ".concat(n.status);throw new l(n.status,e)}}catch(e){let t=n.statusText?"".concat(n.status," ").concat(n.statusText):"Erreur ".concat(n.status);if(e instanceof l)throw e;throw new l(n.status,t)}if(204===n.status)return;return await n.json()}catch(t){throw console.error("[API] Fetch error:",t),new l(0,"Erreur r\xe9seau: ".concat(t.message||"Failed to fetch"))}}},2044:function(t,e,n){"use strict";function r(t){let e=Number(t);return isFinite(e)?"$".concat(Math.round(e).toLocaleString()):"$0"}function s(t){return 52*Number(t||0)/12}n.d(e,{P:function(){return s},l:function(){return r}})},5050:function(t,e,n){"use strict";var r,s;t.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(s=n.g.process)?void 0:s.env)?n.g.process:n(9295)},9295:function(t){!function(){var e={229:function(t){var e,n,r,s=t.exports={};function a(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function c(t){if(e===setTimeout)return setTimeout(t,0);if((e===a||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:a}catch(t){e=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var i=[],l=!1,u=-1;function h(){l&&r&&(l=!1,r.length?i=r.concat(i):u=-1,i.length&&d())}function d(){if(!l){var t=c(h);l=!0;for(var e=i.length;e;){for(r=i,i=[];++u<e;)r&&r[u].run();u=-1,e=i.length}r=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}s.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];i.push(new f(t,e)),1!==i.length||l||c(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(t){return[]},s.binding=function(t){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},n={};function r(t){var s=n[t];if(void 0!==s)return s.exports;var a=n[t]={exports:{}},o=!0;try{e[t](a,a.exports,r),o=!1}finally{o&&delete n[t]}return a.exports}r.ab="//";var s=r(229);t.exports=s}()}},function(t){t.O(0,[115,205,744],function(){return t(t.s=3572)}),_N_E=t.O()}]);