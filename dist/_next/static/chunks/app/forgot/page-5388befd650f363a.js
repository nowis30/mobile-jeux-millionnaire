(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[758],{9479:function(t,e,n){Promise.resolve().then(n.bind(n,1159))},1159:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return s}});var r=n(7821),o=n(8078),a=n(9513);function s(){let[t,e]=(0,o.useState)(""),[n,s]=(0,o.useState)(!1),[c,i]=(0,o.useState)(null),u=async e=>{e.preventDefault(),i(null);try{await (0,a.SC)("/api/auth/request-reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})}),s(!0)}catch(t){i(t instanceof Error?t.message:"\xc9chec de l'envoi")}};return(0,r.jsxs)("main",{className:"max-w-sm mx-auto space-y-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold",children:"Mot de passe oubli\xe9"}),n?(0,r.jsx)("p",{className:"text-sm text-emerald-400",children:"Si un compte existe pour cet e‑mail, un lien de r\xe9initialisation a \xe9t\xe9 envoy\xe9."}):(0,r.jsxs)("form",{onSubmit:u,className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("label",{className:"text-sm text-neutral-300",children:"E‑mail"}),(0,r.jsx)("input",{value:t,onChange:t=>e(t.target.value),type:"email",required:!0,className:"px-3 py-2 rounded bg-neutral-900 border border-neutral-700 text-sm"})]}),c&&(0,r.jsx)("p",{className:"text-sm text-red-400",children:c}),(0,r.jsx)("button",{type:"submit",className:"w-full px-4 py-2 rounded bg-indigo-600 hover:bg-indigo-500",children:"Envoyer le lien"})]})]})}},9513:function(t,e,n){"use strict";n.d(e,{MS:function(){return u},SC:function(){return d},Sg:function(){return i}});var r=n(5050);let o="https://server-jeux-millionnaire.onrender.com",a=!!window.Capacitor,s=/localhost:3000$/.test(window.location.host),c="1"===r.env.NEXT_PUBLIC_FORCE_ABS,i=a||c||!s?o:"";console.log("[API] ABS_BACKEND:",o),console.log("[API] isCapacitor:",a),console.log("[API] isLocalDev:",s),console.log("[API] forceAbs:",c),console.log("[API] API_BASE:",i);class u extends Error{constructor(t,e){super(e),this.name="ApiError",this.status=t,Object.setPrototypeOf(this,u.prototype)}}let l=null,f="HM_TOKEN";async function h(){try{var t;if(l)return l;let e=await fetch("".concat(i,"/api/auth/csrf"),{credentials:"include"});if(!e.ok)return null;let n=await e.json();return l=null!==(t=null==n?void 0:n.csrf)&&void 0!==t?t:null}catch(t){return null}}async function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e.method||"GET").toUpperCase(),r={...e.headers};if(console.log("[API] ".concat(n," ").concat(i).concat(t)),["POST","PUT","PATCH","DELETE"].includes(n)){let t=await h();t&&(r["x-csrf-token"]=t)}let o=function(){try{return window.localStorage.getItem(f)}catch(t){return null}}();o&&(r.Authorization="Bearer ".concat(o));let a=function(){try{let t=window.localStorage.getItem("hm-session");if(!t)return null;return JSON.parse(t).playerId||null}catch(t){return null}}();a&&(r["X-Player-ID"]=a);try{let n=await fetch("".concat(i).concat(t),{credentials:"include",...e,headers:r});if(console.log("[API] Response ".concat(n.status," ").concat(n.statusText)),401===n.status)try{if(o){let n=await fetch("".concat(i,"/api/auth/refresh"),{credentials:"include",headers:{Authorization:"Bearer ".concat(o)}});if(n.ok){let o=await n.json().catch(()=>({}));if(null==o?void 0:o.token){try{window.localStorage.setItem(f,o.token)}catch(t){}r.Authorization="Bearer ".concat(o.token)}let a=await fetch("".concat(i).concat(t),{credentials:"include",...e,headers:r});if(!a.ok)throw new u(a.status,a.statusText);if(204===a.status)return;return await a.json()}}}catch(t){}if(!n.ok)try{if((n.headers.get("content-type")||"").includes("application/json")){let t=await n.json(),e=t&&(t.error||t.message)?String(t.error||t.message):"Erreur ".concat(n.status);throw new u(n.status,e)}{let t=(await n.text()||"").trim(),e=t.length?t:n.statusText?"".concat(n.status," ").concat(n.statusText):"Erreur ".concat(n.status);throw new u(n.status,e)}}catch(e){let t=n.statusText?"".concat(n.status," ").concat(n.statusText):"Erreur ".concat(n.status);if(e instanceof u)throw e;throw new u(n.status,t)}if(204===n.status)return;return await n.json()}catch(t){throw console.error("[API] Fetch error:",t),new u(0,"Erreur r\xe9seau: ".concat(t.message||"Failed to fetch"))}}},5050:function(t,e,n){"use strict";var r,o;t.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(9295)},9295:function(t){!function(){var e={229:function(t){var e,n,r,o=t.exports={};function a(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function c(t){if(e===setTimeout)return setTimeout(t,0);if((e===a||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:a}catch(t){e=a}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var i=[],u=!1,l=-1;function f(){u&&r&&(u=!1,r.length?i=r.concat(i):l=-1,i.length&&h())}function h(){if(!u){var t=c(f);u=!0;for(var e=i.length;e;){for(r=i,i=[];++l<e;)r&&r[l].run();l=-1,e=i.length}r=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function p(){}o.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];i.push(new d(t,e)),1!==i.length||u||c(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=p,o.addListener=p,o.once=p,o.off=p,o.removeListener=p,o.removeAllListeners=p,o.emit=p,o.prependListener=p,o.prependOnceListener=p,o.listeners=function(t){return[]},o.binding=function(t){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var a=n[t]={exports:{}},s=!0;try{e[t](a,a.exports,r),s=!1}finally{s&&delete n[t]}return a.exports}r.ab="//";var o=r(229);t.exports=o}()}},function(t){t.O(0,[115,205,744],function(){return t(t.s=9479)}),_N_E=t.O()}]);