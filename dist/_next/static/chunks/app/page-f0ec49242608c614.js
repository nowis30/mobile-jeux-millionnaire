(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931,468],{3657:function(e,t,a){Promise.resolve().then(a.bind(a,3253))},3253:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var n=a(7821),r=a(4233),l=a(4328),s=a(8078),i=a(168),o=a(2705),c=a(1468),d=a(9513),u=a(2044),m=a(6325);let h="lobby";function x(){let e=(0,i.useRouter)(),[t,a]=(0,s.useState)(!1),[x,f]=(0,s.useState)(!1),[b,v]=(0,s.useState)(""),[y,j]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{console.log("[Auth] Tentative /api/auth/me ...");let e=await (0,d.SC)("/api/auth/me");console.log("[Auth] Succ\xe8s /api/auth/me",e),a(!0),f(!!e.isAdmin),v(e.email),j(null);try{window.dispatchEvent(new Event("hm-music/resume")),window.dispatchEvent(new Event("hm-music/play-now"))}catch(e){}}catch(n){a(!1),f(!1),v(""),j("Non connect\xe9. Redirection vers la page de connexion..."),setTimeout(()=>{t||e.replace("/login")},1200)}})()},[e,t]);let[w,N]=(0,s.useState)([]),[S,A]=(0,s.useState)(""),[k,C]=(0,s.useState)(""),[I,P]=(0,s.useState)(""),[E,M]=(0,s.useState)(h),[T,D]=(0,s.useState)([]),[R,q]=(0,s.useState)(null),[O,z]=(0,s.useState)(null),[B,L]=(0,s.useState)(""),[F,Q]=(0,s.useState)([]),[V,G]=(0,s.useState)(""),[_,J]=(0,s.useState)(null),[U,$]=(0,s.useState)(null),[W,H]=(0,s.useState)([]),[X,K]=(0,s.useState)([]),[Y,Z]=(0,s.useState)({}),[ee,et]=(0,s.useState)(null),[ea,en]=(0,s.useState)([]),[er,el]=(0,s.useState)(!1),[es,ei]=(0,s.useState)(!1),[eo,ec]=(0,s.useState)(!1),[ed,eu]=(0,s.useState)(null),[em,eh]=(0,s.useState)(!1),[ex,ep]=(0,s.useState)(null),[eg,ef]=(0,s.useState)([]),[eb,ev]=(0,s.useState)(null),[ey,ej]=(0,s.useState)(1e6),[ew,eN]=(0,s.useState)(0),[eS,eA]=(0,s.useState)(!1),[ek,eC]=(0,s.useState)(!1),[eI,eP]=(0,s.useState)(null),[eE,eM]=(0,s.useState)(null),[eT,eD]=(0,s.useState)(!1),[eR,eq]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=(0,o.dF)();if(e){var t;A(e.gameId),C(null!==(t=e.playerId)&&void 0!==t?t:""),e.nickname&&G(e.nickname)}},[]),(0,s.useEffect)(()=>{try{var e,t;eq(!!(null===(t=window.Capacitor)||void 0===t?void 0:null===(e=t.isNativePlatform)||void 0===e?void 0:e.call(t)))}catch(e){eq(!1)}},[]),(0,s.useEffect)(()=>{try{localStorage.getItem("hm-tutorial-home")||eh(!0)}catch(e){}},[]),(0,s.useEffect)(()=>{if(S&&k)try{let e=new URLSearchParams(window.location.search).get("invite");if(!e||localStorage.getItem("hm-invite-accepted-".concat(e)))return;(async()=>{try{await (0,d.SC)("/api/games/".concat(S,"/referrals/accept"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e})}),localStorage.setItem("hm-invite-accepted-".concat(e),"1"),ep(e)}catch(e){}})()}catch(e){}},[S,k]);let eO=(0,s.useCallback)(e=>{var t,a,n;let r={gameId:null!==(t=null==e?void 0:e.gameId)&&void 0!==t?t:S,playerId:null!==(a=null==e?void 0:e.playerId)&&void 0!==a?a:k,nickname:null!==(n=null==e?void 0:e.nickname)&&void 0!==n?n:V};r.gameId&&(0,o.Aj)(r)},[S,k,V]),ez=(0,s.useCallback)(async()=>{if(S)try{var e,t;console.log("[Home] Fetch state gameId=",S);let a=await (0,d.SC)("/api/games/".concat(S,"/state"));console.log("[Home] State re\xe7u:",a),M(a.status),D(null!==(e=a.players)&&void 0!==e?e:[]),P(null!==(t=a.code)&&void 0!==t?t:""),q(null)}catch(e){console.warn("[Home] \xc9chec state",e),q(e instanceof Error?e.message:"\xc9chec de r\xe9cup\xe9ration de l'\xe9tat")}},[S]),eB=(0,s.useCallback)(async()=>{if(S&&k)try{var e;let t=await (0,d.SC)("/api/games/".concat(S,"/bonus/status"));eA(!!t.available),eN(Math.max(0,Number(null!==(e=t.secondsUntilAvailable)&&void 0!==e?e:0))),"number"!=typeof t.rewardAmount||Number.isNaN(t.rewardAmount)||ej(t.rewardAmount),eM(null)}catch(e){if((null==e?void 0:e.status)===404)return;(null==e?void 0:e.message)?eM(e.message):eM("Impossible de r\xe9cup\xe9rer le bonus.")}},[S,k]),eL=(0,s.useCallback)(e=>{let t=Math.max(0,Math.floor(e)),a=Math.floor(t/60),n=t%60;return a>0?"".concat(a,"min ").concat(n,"s"):"".concat(n,"s")},[]),eF=(0,s.useCallback)(async()=>{if(!eo&&t&&!S){ec(!0),console.log("[Home] AutoJoin d\xe9clench\xe9 isLoggedIn=",t,"gameId=",S);try{var e;let t=await (0,d.SC)("/api/games");console.log("[Home] Liste des games:",t);let a=null===(e=t.games)||void 0===e?void 0:e[0];if(!a)throw Error("Partie introuvable");let n=await (0,d.SC)("/api/games/".concat(a.id,"/join"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});console.log("[Home] Join OK:",n),A(a.id),C(n.playerId),P(a.code),G(b),eO({gameId:a.id,playerId:n.playerId,nickname:b}),q(null),z("Vous avez rejoint la partie mondiale en tant que ".concat(b)),ez()}catch(e){console.error("[AutoJoin] Erreur join:",(null==e?void 0:e.message)||e)}}},[eo,t,S,b,eO,ez]),eQ=(0,s.useCallback)(async()=>{if(!S||!k){eM("Rejoignez la partie mondiale pour d\xe9bloquer le bonus.");return}if(!ek){eC(!0),eM(null),eP(null);try{var e,t;if(!await (0,m.fL)((e,t)=>{console.log("[Bonus] Reward callback ".concat(e," ").concat(t))})){eM("La publicit\xe9 n'est pas pr\xeate. R\xe9essayez dans quelques instants.");return}let a=await (0,d.SC)("/api/games/".concat(S,"/bonus/redeem"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),n=Number(null!==(e=null==a?void 0:a.rewardAmount)&&void 0!==e?e:ey);ej(n),eP("+".concat((0,u.l)(n)));let r=Number(null!==(t=null==a?void 0:a.secondsUntilNext)&&void 0!==t?t:0),l=(0,m.Ie)();eN(Math.max(r,l)),eA(!1),eB(),ez()}catch(e){(null==e?void 0:e.status)===429&&eB(),eM((null==e?void 0:e.message)||"Impossible de cr\xe9diter le bonus.")}finally{eC(!1)}}},[S,k,ek,ey,eB,ez]);(0,s.useEffect)(()=>{eF()},[eF]),(0,s.useEffect)(()=>{if(S&&b)try{let e=(0,l.io)(d.Sg,{path:"/socket.io",transports:["websocket"],withCredentials:!0,query:{gameId:S,nickname:b}});ev(e);let t=async()=>{try{let e=await fetch("".concat(d.Sg,"/api/games/").concat(S,"/online"),{credentials:"include"});if(!e.ok)return;let t=await e.json();ef(Array.isArray(t.users)?t.users:[])}catch(e){}};t();let a=setInterval(t,15e3);return()=>{try{clearInterval(a)}catch(e){}e.close(),ev(null)}}catch(e){}},[S,b]);let eV=(0,s.useCallback)(async e=>{if(S){$(e);try{var t,a,n,r,l,s;let[i,o,c,u,m]=await Promise.all([fetch("".concat(d.Sg,"/api/games/").concat(S,"/properties/holdings/").concat(e.id),{credentials:"include"}),fetch("".concat(d.Sg,"/api/games/").concat(S,"/markets/holdings/").concat(e.id),{credentials:"include"}),fetch("".concat(d.Sg,"/api/games/").concat(S,"/markets/latest"),{credentials:"include"}),fetch("".concat(d.Sg,"/api/games/").concat(S,"/economy"),{credentials:"include"}),fetch("".concat(d.Sg,"/api/quiz/public-stats"),{credentials:"include"})]),h=i.ok?await i.json():{holdings:[]},x=o.ok?await o.json():{holdings:[]},p=c.ok?await c.json():{prices:[]},g=u.ok?await u.json():null,f=m.ok?await m.json():null;H(null!==(t=h.holdings)&&void 0!==t?t:[]),K(null!==(a=x.holdings)&&void 0!==a?a:[]);let b={};for(let e of null!==(n=p.prices)&&void 0!==n?n:[])b[e.symbol]=e.price;if(Z(b),g&&et({baseMortgageRate:Number(null!==(r=g.baseMortgageRate)&&void 0!==r?r:.05),appreciationAnnual:Number(null!==(l=g.appreciationAnnual)&&void 0!==l?l:.02),schedule:Array.isArray(g.schedule)?g.schedule:[]}),f){let e=Array.isArray(f.categories)?f.categories.map(e=>{var t,a,n,r;return{category:String(null!==(t=e.category)&&void 0!==t?t:"autre"),total:Number(null!==(a=e.total)&&void 0!==a?a:0),used:Number(null!==(n=e.used)&&void 0!==n?n:0),remaining:Number(null!==(r=e.remaining)&&void 0!==r?r:0)}}):void 0;eu({remaining:Number(null!==(s=f.remaining)&&void 0!==s?s:0),remainingByDifficulty:f.remainingByDifficulty,remainingByCategory:f.remainingByCategory,categories:e})}}catch(e){}}},[S]),eG=(0,s.useCallback)(()=>{var e,t,a;if(!U){en([]);return}let n=((null==ee?void 0:ee.schedule)&&ee.schedule.length?ee.schedule:Array.from({length:10},()=>.02)).slice(0,10),r=null!==(e=null==ee?void 0:ee.baseMortgageRate)&&void 0!==e?e:.05,l=(W||[]).map(e=>{var t,a,n;let l=Number(null!==(t=e.currentValue)&&void 0!==t?t:0),s=Number(null!==(a=e.mortgageDebt)&&void 0!==a?a:0),i=Number(null!==(n=e.weeklyPayment)&&void 0!==n?n:0)||function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,n=Math.max(1,Math.round(52*a)),r=t/52;return e<=0?0:r<=0?e/n:r*e/(1-Math.pow(1+r,-n))}(s,r,25);return{value:l,debt:s,rate:r,payW:i}}),s=(X||[]).map(e=>{var t,a,n;let r=null!==(a=Y[e.symbol])&&void 0!==a?a:Number(null!==(t=e.avgPrice)&&void 0!==t?t:0);return{value:Number(null!==(n=e.quantity)&&void 0!==n?n:0)*Number(null!=r?r:0),er:function(e){switch(e){case"SP500":case"VFV":case"XLF":case"XLE":case"IWM":return .06;case"QQQ":case"AAPL":case"MSFT":case"AMZN":case"META":case"GOOGL":case"NVDA":case"TSLA":case"COST":return .08;case"TSX":case"VDY":default:return .05;case"UPRO":return .18;case"TQQQ":return .24;case"GLD":return .02;case"TLT":return .03}}(String(e.symbol))}}),i=Number(null!==(t=U.cash)&&void 0!==t?t:0),o=[],c=l.reduce((e,t)=>e+(t.value-t.debt),0)+s.reduce((e,t)=>e+t.value,0)+i;o.push({year:0,net:c});let d=l.map(e=>({...e})),u=s.map(e=>({...e}));for(let e=1;e<=10;e++){for(let t of d){let r=Math.max(0,52*t.payW-t.debt*t.rate);t.debt=Math.max(0,t.debt-r),t.value=t.value*(1+(null!==(a=n[e-1])&&void 0!==a?a:.02))}for(let e of u)e.value=e.value*(1+e.er);let t=d.reduce((e,t)=>e+(t.value-t.debt),0)+u.reduce((e,t)=>e+t.value,0)+i;o.push({year:e,net:t})}en(o)},[U,W,X,Y,ee]);(0,s.useEffect)(()=>{if(!es){en([]);return}el(!0);try{eG()}finally{el(!1)}},[es,U,W,X,Y,ee]),(0,s.useCallback)(async()=>{try{var e;let t=await (0,d.SC)("/api/games"),a=null===(e=t.games)||void 0===e?void 0:e[0];if(!a)throw Error("Partie introuvable");let n=await (0,d.SC)("/api/games/".concat(a.id,"/join"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});A(a.id),C(n.playerId),P(a.code),eO({gameId:a.id,playerId:n.playerId}),q(null),z("Rejoint la partie ".concat(a.code)),ez()}catch(e){z(null),q(e instanceof Error?e.message:"Impossible de rejoindre la partie")}},[eO,ez]);let e_=(0,s.useCallback)(async()=>{try{let n=S;if(!n){var e,t,a;let r=await (0,d.SC)("/api/games");if(!(n=null!==(a=null===(t=r.games)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.id)&&void 0!==a?a:""))throw Error("Partie introuvable");A(n)}await (0,d.SC)("/api/games/".concat(n,"/start"),{method:"POST"}),z("Partie d\xe9marr\xe9e"),ez()}catch(e){q(e instanceof Error?e.message:"\xc9chec du d\xe9marrage")}},[S,ez]),eJ=(0,s.useCallback)(async()=>{try{if(!window.confirm("Red\xe9marrer la partie effacera joueurs, annonces, positions et historique. Continuer ?"))return;let n=S;if(!n){var e,t,a;let r=await (0,d.SC)("/api/games");if(!(n=null!==(a=null===(t=r.games)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.id)&&void 0!==a?a:""))throw Error("Partie introuvable");A(n)}console.log("[DEBUG] Calling restart for game ".concat(n)),await (0,d.SC)("/api/games/".concat(n,"/restart"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirm:!0})}),console.log("[DEBUG] Restart successful"),z("Partie red\xe9marr\xe9e avec succ\xe8s!"),q(null),(0,o.Ov)(),A(""),C(""),G(""),ez()}catch(e){console.error("[DEBUG] Restart error:",e),q(e instanceof Error?e.message:"\xc9chec du red\xe9marrage")}},[S,ez]);(0,s.useCallback)(()=>{(0,o.Ov)(),A(""),C(""),G(""),P(""),D([]),N([]),M(h),z("Session effac\xe9e")},[]);let eU=window.location.origin,[e$,eW]=(0,s.useState)(""),[eH,eX]=(0,s.useState)(null),eK=(0,s.useCallback)(async()=>{try{navigator.share?(await navigator.share({title:"Rejoins le jeu du Millionnaire",text:"Clique pour te connecter et rejoindre la partie globale.",url:eU}),J("Lien partag\xe9")):navigator.clipboard?(await navigator.clipboard.writeText(eU),J("Lien copi\xe9 dans le presse-papiers")):J("Partage non support\xe9. Copiez l'URL du navigateur.")}catch(e){J("Partage annul\xe9")}},[eU]),eY=(0,s.useCallback)(async()=>{try{if(!S)throw Error("Partie introuvable");let e=await (0,d.SC)("/api/games/".concat(S,"/referrals/create"),{method:"POST"});eW(e.url),eX("Lien g\xe9n\xe9r\xe9. R\xe9compense: ".concat((0,u.l)(e.reward||1e6))),navigator.share?await navigator.share({title:"Rejoins le Millionnaire",text:"Accepte mon invitation et commen\xe7ons !",url:e.url}):navigator.clipboard&&(await navigator.clipboard.writeText(e.url),eX(e=>e?e+" — Lien copi\xe9":"Lien copi\xe9"))}catch(e){eX((null==e?void 0:e.message)||"\xc9chec de cr\xe9ation du lien")}},[S]);(0,s.useEffect)(()=>{S&&ez()},[S,ez]),(0,s.useEffect)(()=>{eB()},[eB]),(0,s.useEffect)(()=>{if(ew<=0)return;let e=setTimeout(()=>{eN(e=>Math.max(0,e-1))},1e3);return()=>clearTimeout(e)},[ew]),(0,s.useEffect)(()=>{let e=!0,t=async()=>{try{let t=await (0,m.yk)();e&&eD(t)}catch(t){e&&eD(!1)}};t();let a=setInterval(t,5e3);return()=>{e=!1,clearInterval(a)}},[]),(0,s.useEffect)(()=>{if(!eR)return;let e=()=>{let e=(0,m.Ie)();e>0&&eN(t=>e>t?e:t)};e();let t=setInterval(e,5e3);return()=>clearInterval(t)},[eR]),(0,s.useEffect)(()=>{S&&!k&&(async()=>{try{try{let e=await (0,d.SC)("/api/games/".concat(S,"/me"));C(e.player.id),e.player.nickname&&G(e.player.nickname),eO({gameId:S,playerId:e.player.id,nickname:e.player.nickname})}catch(e){}}catch(e){}})()},[S,k,eO]);let eZ=(0,s.useMemo)(()=>w.length>0?w:T.map(e=>({playerId:e.id,nickname:e.nickname,netWorth:e.netWorth})).sort((e,t)=>t.netWorth-e.netWorth),[w,T]),e0=!S||!k||ek||ew>0||!eT,e2=S&&k?ek?"Chargement de la publicit\xe9...":ew>0?"Disponible dans ".concat(eL(ew)):eT?"Regarder la publicit\xe9 pour ".concat((0,u.l)(ey)):eR?"Chargement de la publicit\xe9...":"Disponible dans l'app mobile":"Connexion en cours...";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("main",{className:"space-y-6 overflow-x-hidden",children:[(0,n.jsxs)("div",{className:"text-xs opacity-60",children:["DEBUG API_BASE: ",d.Sg]}),(0,n.jsx)(()=>y?(0,n.jsxs)("div",{className:"p-3 mb-4 rounded bg-red-900/40 border border-red-700 text-sm",children:[(0,n.jsxs)("p",{className:"font-semibold",children:["Auth: ",y]}),(0,n.jsx)("p",{className:"mt-1 text-xs opacity-75",children:"Si cela persiste, ouvrez la page /debug-auth pour plus de d\xe9tails (token, cookies)."})]}):null,{}),(0,n.jsxs)("div",{className:"rounded-lg border border-indigo-600 bg-gradient-to-r from-indigo-700/60 to-purple-700/50 p-3 flex flex-col md:flex-row md:items-center md:justify-between gap-2 shadow",children:[(0,n.jsx)("div",{className:"text-sm md:text-base font-semibold text-indigo-100 flex items-center gap-2",children:(0,n.jsx)("span",{children:"✨ Nouveaut\xe9s: Difficult\xe9 Quiz r\xe9\xe9quilibr\xe9e, cat\xe9gorie Anatomy (biologie), tutoriel complet."})}),(0,n.jsxs)("div",{className:"text-xs flex items-center gap-3",children:[(0,n.jsx)(r.default,{href:"/tutoriel",className:"px-3 py-1 rounded bg-indigo-500 hover:bg-indigo-400 text-black font-medium text-xs",children:"Voir le tutoriel"}),(0,n.jsx)(r.default,{href:"/quiz",className:"px-3 py-1 rounded bg-purple-500 hover:bg-purple-400 text-black font-medium text-xs",children:"Jouer au Quiz"}),(0,n.jsx)(r.default,{href:"/telecharger",className:"px-3 py-1 rounded bg-emerald-500 hover:bg-emerald-400 text-black font-medium text-xs",children:"T\xe9l\xe9charger l'app"})]})]}),(0,n.jsx)(g,{}),t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("section",{className:"rounded-xl border border-emerald-600/60 bg-gradient-to-r from-emerald-900/70 to-green-800/60 p-4 shadow-lg space-y-3",children:[(0,n.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,n.jsxs)("div",{className:"space-y-1 text-sm text-emerald-100",children:[(0,n.jsxs)("p",{className:"text-lg md:text-xl font-semibold text-white",children:["Bonus pub : ",(0,u.l)(ey)]}),(0,n.jsxs)("p",{className:"text-emerald-100/80 text-sm",children:["Regardez une publicit\xe9 pour cr\xe9diter instantan\xe9ment ",(0,u.l)(ey)," sur votre compte."]})]}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 w-full md:w-auto",children:[(0,n.jsx)("button",{onClick:eQ,disabled:e0,className:"px-4 py-2 rounded-lg font-semibold transition-all w-full sm:w-auto ".concat(e0?"bg-emerald-700/40 text-emerald-200/70 cursor-not-allowed":"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-400 hover:to-green-400 text-black shadow-lg shadow-emerald-900/40"),children:e2}),(0,n.jsx)(r.default,{href:"/bonus",className:"text-xs text-emerald-100/80 underline text-center",children:"En savoir plus"})]})]}),!eR&&(0,n.jsx)("p",{className:"text-xs text-emerald-100/70 text-center md:text-right",children:"Disponible dans l'application mobile. T\xe9l\xe9chargez-la via l'onglet T\xe9l\xe9charger."}),eI&&(0,n.jsxs)("div",{className:"rounded-lg border border-emerald-500/60 bg-emerald-500/15 px-3 py-2 text-sm text-emerald-100 text-center",children:[eI," cr\xe9dit\xe9 sur votre compte !"]}),eE&&(0,n.jsx)("div",{className:"rounded-lg border border-rose-500/40 bg-rose-500/10 px-3 py-2 text-sm text-rose-100 text-center",children:eE})]}),(0,n.jsxs)("section",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Partie Mondiale du Millionnaire"}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[b&&(0,n.jsxs)("p",{className:"text-sm text-neutral-400 flex items-center gap-2",children:["Connect\xe9: ",(0,n.jsxs)("span",{className:"text-emerald-400 flex items-center gap-1",children:[eg.includes(b)&&(0,n.jsx)("span",{className:"inline-block w-2 h-2 rounded-full bg-green-500",title:"En ligne"}),b]})]}),x&&(0,n.jsx)("span",{className:"px-2 py-1 rounded bg-red-700 text-xs font-semibold",children:"ADMIN"})]})]}),S&&k&&(0,n.jsxs)("div",{className:"bg-emerald-900/30 border border-emerald-700/50 rounded-lg p-3",children:[(0,n.jsx)("p",{className:"text-emerald-300 text-sm",children:"✅ Vous \xeates automatiquement inscrit \xe0 la partie mondiale !"}),(0,n.jsxs)("p",{className:"text-neutral-400 text-xs mt-1",children:["Pseudo: ",V||b]})]}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 w-full",children:[(0,n.jsx)("button",{onClick:async()=>{try{await (0,d.SC)("/api/auth/logout",{method:"POST"})}catch(e){}try{if("undefined"!=typeof document){let e="Thu, 01 Jan 1970 00:00:00 GMT";document.cookie="hm_auth=; expires="+e+"; path=/",document.cookie="hm_csrf=; expires="+e+"; path=/",document.cookie="hm_guest=; expires="+e+"; path=/"}}catch(e){}try{window.localStorage.removeItem("HM_TOKEN")}catch(e){}try{window.localStorage.removeItem("hm-session")}catch(e){}(0,o.Ov)(),a(!1),f(!1),v(""),e.replace("/login")},className:"px-4 py-2 rounded bg-rose-700 hover:bg-rose-600 w-full sm:w-auto",children:"Se d\xe9connecter"}),(0,n.jsx)("button",{onClick:eY,className:"px-4 py-2 rounded bg-emerald-600 hover:bg-emerald-500 w-full sm:w-auto",children:"Inviter un ami (gagne 1M$)"}),(0,n.jsx)("button",{onClick:eK,className:"px-4 py-2 rounded bg-indigo-600 hover:bg-indigo-500 w-full sm:w-auto",children:"Partager le jeu"}),(0,n.jsx)("a",{href:"mailto:?subject=".concat(encodeURIComponent("Rejoins le jeu du Millionnaire"),"&body=").concat(encodeURIComponent("Rejoins-moi: "+eU)),className:"px-4 py-2 rounded bg-indigo-700 hover:bg-indigo-600 text-center w-full sm:w-auto",children:"Inviter par email"})]}),e$&&(0,n.jsxs)("div",{className:"text-xs text-neutral-300",children:["Lien d'invitation: ",(0,n.jsx)("a",{href:e$,className:"underline break-all",children:e$})]}),(eH||_)&&(0,n.jsx)("p",{className:"text-xs text-neutral-400",children:eH||_}),ex&&(0,n.jsx)("p",{className:"text-xs text-emerald-400",children:"Invitation appliqu\xe9e. Merci !"}),O&&(0,n.jsx)("p",{className:"text-sm text-emerald-400",children:O}),R&&(0,n.jsx)("p",{className:"text-sm text-red-400",children:R})]})]}):(0,n.jsxs)("section",{className:"space-y-3",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Connexion requise"}),(0,n.jsx)("p",{className:"text-neutral-300",children:"Veuillez vous connecter pour cr\xe9er ou rejoindre une partie."}),(0,n.jsx)("a",{href:"/login",className:"px-4 py-2 rounded bg-indigo-600 hover:bg-indigo-500 inline-block",children:"Aller \xe0 la page de connexion"})]}),(0,n.jsxs)("section",{children:[(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Tableau de bord"}),(0,n.jsxs)("p",{className:"text-sm text-neutral-300",children:["Classement (rafra\xeechissement manuel) — statut: ",E]}),(0,n.jsx)("div",{className:"mt-2 flex gap-2",children:(0,n.jsx)("button",{onClick:ez,className:"px-3 py-2 rounded bg-neutral-700 hover:bg-neutral-600 text-sm",children:"Actualiser"})}),(0,n.jsx)("div",{className:"mt-4 bg-neutral-900 rounded border border-neutral-800 overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full text-sm",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"text-left",children:[(0,n.jsx)("th",{className:"p-2",children:"#"}),(0,n.jsx)("th",{className:"p-2",children:"Joueur"}),(0,n.jsx)("th",{className:"p-2",children:"Valeur nette"})]})}),(0,n.jsx)("tbody",{children:eZ.map((e,t)=>(0,n.jsxs)("tr",{className:"border-t border-neutral-800",children:[(0,n.jsx)("td",{className:"p-2",children:t+1}),(0,n.jsxs)("td",{className:"p-2 flex items-center gap-2",children:[eg.includes(e.nickname)&&(0,n.jsx)("span",{className:"inline-block w-2 h-2 rounded-full bg-green-500",title:"En ligne"}),e.nickname]}),(0,n.jsx)("td",{className:"p-2",children:(0,u.l)(e.netWorth)})]},e.playerId))})]})})]}),T.length>0&&(0,n.jsxs)("section",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:"Joueurs"}),(0,n.jsx)("ul",{className:"mt-2 space-y-2 text-sm text-neutral-300",children:T.map(e=>(0,n.jsxs)("li",{className:"border border-neutral-800 rounded px-3 py-2 bg-neutral-900",children:[(0,n.jsxs)("div",{className:"text-base font-medium mb-2 flex items-center gap-2",children:[eg.includes(e.nickname)&&(0,n.jsx)("span",{className:"inline-block w-2 h-2 rounded-full bg-green-500",title:"En ligne"}),e.nickname]}),(0,n.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,n.jsxs)("span",{children:["Cash: ",(0,u.l)(e.cash)," | Net: ",(0,u.l)(e.netWorth)]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{title:"Voir le portefeuille",onClick:()=>eV(e),className:"px-2 py-1 rounded bg-indigo-600 hover:bg-indigo-500 text-xs",children:"Voir portefeuille"}),x&&(0,n.jsx)("button",{title:"Supprimer ce joueur",onClick:async()=>{if(S&&window.confirm("Supprimer ".concat(e.nickname," ? Tous ses biens, annonces et positions seront effac\xe9s.")))try{await (0,d.SC)("/api/games/".concat(S,"/players/").concat(e.id),{method:"DELETE"}),z("Joueur supprim\xe9: ".concat(e.nickname)),ez()}catch(e){q(e instanceof Error?e.message:"\xc9chec de suppression")}},className:"px-2 py-1 rounded bg-red-700 hover:bg-red-600 text-xs",children:"Poubelle"})]})]})]},e.id))})]}),x&&(0,n.jsxs)("section",{className:"space-y-2 border border-red-900/40 bg-red-950/20 rounded p-3",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-red-300",children:"Admin"}),(0,n.jsx)("p",{className:"text-sm text-red-200/80",children:"Contr\xf4les r\xe9serv\xe9s \xe0 l'administrateur. Le red\xe9marrage efface toutes les donn\xe9es de la partie."}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:e_,className:"px-3 py-2 rounded bg-orange-600 hover:bg-orange-500 text-sm",children:"D\xe9marrer"}),(0,n.jsx)("button",{onClick:eJ,className:"px-3 py-2 rounded bg-red-700 hover:bg-red-600 text-sm",children:"Red\xe9marrer (destructif)"})]}),(0,n.jsx)(p,{gameId:S,onAdvanced:()=>{ez()}})]}),(0,n.jsxs)("section",{className:"grid grid-cols-2 sm:grid-cols-5 gap-3 w-full",children:[(0,n.jsx)(r.default,{href:"/immobilier",className:"px-4 py-2 rounded bg-sky-600 hover:bg-sky-500 text-center w-full",children:"Immobilier"}),(0,n.jsx)(r.default,{href:"/bourse",className:"px-4 py-2 rounded bg-emerald-600 hover:bg-emerald-500 text-center w-full",children:"Bourse"}),(0,n.jsx)(r.default,{href:"/listings",className:"px-4 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-center w-full",children:"Annonces"}),(0,n.jsx)(r.default,{href:"/summary",className:"px-4 py-2 rounded bg-amber-600 hover:bg-amber-500 text-center w-full",children:"R\xe9sum\xe9"}),(0,n.jsx)(r.default,{href:"/quiz",className:"px-4 py-2 rounded bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 font-bold text-center w-full",children:"\uD83D\uDCB0 Quiz"})]}),(0,n.jsx)("section",{className:"w-full",children:(0,n.jsx)(r.default,{href:"/bonus",className:"block px-6 py-3 rounded-lg bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 font-bold text-center w-full text-lg shadow-lg transition-all hover:scale-105",children:"\uD83D\uDCFA Bonus Gratuit - Gagnez $1,000,000 !"})}),U&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-start justify-center p-4",onClick:()=>$(null),children:(0,n.jsxs)("div",{className:"w-full max-w-4xl bg-neutral-900 border border-neutral-800 rounded-lg flex flex-col max-h-[85vh]",onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-neutral-800",children:[(0,n.jsxs)("h4",{className:"font-semibold",children:["Portefeuille — ",U.nickname]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:["number"==typeof(null==ed?void 0:ed.remaining)&&(0,n.jsxs)("span",{className:"text-xs px-2 py-1 rounded bg-emerald-800/50 border border-emerald-700 text-emerald-200",children:["Questions en banque: ",ed.remaining]}),(null==ed?void 0:ed.categories)&&ed.categories.length>0?(0,n.jsxs)("div",{className:"flex items-center gap-1 flex-wrap max-w-[60vw]",children:[ed.categories.slice(0,5).map(e=>(0,n.jsxs)("span",{className:"text-[10px] px-2 py-1 rounded bg-neutral-800 border border-neutral-700 text-neutral-300",children:[e.category," ",e.remaining]},e.category)),ed.categories.length>5&&(0,n.jsxs)("span",{className:"text-[10px] px-2 py-1 rounded bg-neutral-800 border border-neutral-700 text-neutral-300",children:["+",ed.categories.length-5," autres"]})]}):(null==ed?void 0:ed.remainingByCategory)&&(0,n.jsx)("span",{className:"text-[10px] px-2 py-1 rounded bg-neutral-800 border border-neutral-700 text-neutral-300",children:"Finance ".concat(ed.remainingByCategory.finance," \xb7 \xc9conomie ").concat(ed.remainingByCategory.economy," \xb7 Immo ").concat(ed.remainingByCategory.realEstate)})]})]}),(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,n.jsxs)("div",{className:"p-4 grid gap-4 md:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h5",{className:"font-semibold mb-2",children:"Immobilier"}),0===W.length?(0,n.jsx)("p",{className:"text-sm text-neutral-400",children:"Aucun bien."}):(0,n.jsxs)("table",{className:"w-full text-sm bg-neutral-950 border border-neutral-800 rounded",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"text-left",children:[(0,n.jsx)("th",{className:"p-2",children:"Bien"}),(0,n.jsx)("th",{className:"p-2",children:"Valeur"}),(0,n.jsx)("th",{className:"p-2",children:"Dette"})]})}),(0,n.jsx)("tbody",{children:W.map(e=>{var t,a,r,l,s,i;return(0,n.jsxs)("tr",{className:"border-t border-neutral-800",children:[(0,n.jsxs)("td",{className:"p-2",children:[null!==(r=null===(t=e.template)||void 0===t?void 0:t.name)&&void 0!==r?r:"Bien",(0,n.jsx)("div",{className:"text-xs text-neutral-500",children:null!==(l=null===(a=e.template)||void 0===a?void 0:a.city)&&void 0!==l?l:""})]}),(0,n.jsx)("td",{className:"p-2",children:(0,u.l)(Number(null!==(s=e.currentValue)&&void 0!==s?s:0))}),(0,n.jsx)("td",{className:"p-2",children:(0,u.l)(Number(null!==(i=e.mortgageDebt)&&void 0!==i?i:0))})]},e.id)})})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h5",{className:"font-semibold mb-2",children:"Bourse"}),0===X.length?(0,n.jsx)("p",{className:"text-sm text-neutral-400",children:"Aucune position."}):(0,n.jsxs)("table",{className:"w-full text-sm bg-neutral-950 border border-neutral-800 rounded",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"text-left",children:[(0,n.jsx)("th",{className:"p-2",children:"Actif"}),(0,n.jsx)("th",{className:"p-2",children:"Qt\xe9"}),(0,n.jsx)("th",{className:"p-2",children:"Prix moy."}),(0,n.jsx)("th",{className:"p-2",children:"Valeur"}),(0,n.jsx)("th",{className:"p-2",children:"Gain %"})]})}),(0,n.jsx)("tbody",{children:X.map(e=>{var t,a,r,l,s;let i=null!==(t=Y[e.symbol])&&void 0!==t?t:e.avgPrice,o=Number(null!==(a=e.quantity)&&void 0!==a?a:0)*Number(null!=i?i:0),c=Number(null!==(r=e.avgPrice)&&void 0!==r?r:0)||0,d=c>0?(Number(null!=i?i:0)-c)/c*100:0;return(0,n.jsxs)("tr",{className:"border-t border-neutral-800",children:[(0,n.jsx)("td",{className:"p-2",children:e.symbol}),(0,n.jsx)("td",{className:"p-2",children:Number(null!==(l=e.quantity)&&void 0!==l?l:0).toFixed(2)}),(0,n.jsxs)("td",{className:"p-2",children:["$",Number(null!==(s=e.avgPrice)&&void 0!==s?s:0).toFixed(2)]}),(0,n.jsxs)("td",{className:"p-2",children:["$",o.toFixed(2)]}),(0,n.jsx)("td",{className:"p-2",children:(0,n.jsxs)("span",{className:d>=0?"text-emerald-400":"text-red-400",children:[d.toFixed(2),"%"]})})]},e.id)})})]})]})]}),(0,n.jsx)("div",{className:"px-4 pb-4",children:(0,n.jsxs)("div",{className:"mt-2 space-y-2",children:[(0,n.jsx)("button",{className:"px-3 py-2 rounded bg-neutral-700 hover:bg-neutral-600 text-sm",onClick:()=>ei(!0),disabled:es&&er,children:es?er?"Calcul en cours…":"Recalculer la projection":"Afficher la projection 10 ans"}),es&&ea.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-baseline justify-between",children:[(0,n.jsx)("h5",{className:"font-semibold",children:"Projection 10 ans (valeur nette totale)"}),(0,n.jsxs)("span",{className:"text-xs text-neutral-400",children:["de ",(0,u.l)(Math.round(ea[0].net))," \xe0 ",(0,u.l)(Math.round(ea[ea.length-1].net))]})]}),(0,n.jsx)(function(e){let{data:t}=e;if(!t||0===t.length)return null;let a=Math.min(...t.map(e=>e.net)),r=Math.max(...t.map(e=>e.net)),l=a===r?.95*a:.98*a,s=a===r?1.05*r:1.02*r,i=e=>28+744*e/Math.max(1,t.length-1),o=e=>172-(e-l)*144/Math.max(1,s-l),c=t.map((e,t)=>"".concat(i(t),",").concat(o(e.net))).join(" "),d=e=>e>=1e6?"".concat((e/1e6).toFixed(2)," M$"):e>=1e3?"".concat((e/1e3).toFixed(1)," k$"):"$".concat(Math.round(e));return(0,n.jsx)("div",{className:"w-full overflow-x-auto",children:(0,n.jsxs)("svg",{viewBox:"0 0 ".concat(800," ").concat(200),className:"w-full h-48 bg-neutral-950 border border-neutral-800 rounded",children:[(0,n.jsx)("line",{x1:28,y1:172,x2:772,y2:172,stroke:"#333"}),(0,n.jsx)("line",{x1:28,y1:28,x2:28,y2:172,stroke:"#333"}),(0,n.jsx)("text",{x:28,y:20,fill:"#9ca3af",fontSize:"10",textAnchor:"start",children:d(s)}),(0,n.jsx)("text",{x:28,y:184,fill:"#9ca3af",fontSize:"10",textAnchor:"start",children:d(l)}),(0,n.jsx)("polyline",{fill:"none",stroke:"#22c55e",strokeWidth:2,points:c})]})})},{data:ea})]})]})})]}),(0,n.jsx)("div",{className:"px-4 py-3 border-t border-neutral-800 flex justify-center",children:(0,n.jsx)("button",{onClick:()=>$(null),className:"px-4 py-2 rounded bg-neutral-700 hover:bg-neutral-600 text-sm",children:"Fermer"})})]})})]}),em&&(0,n.jsx)(c.default,{onClose:()=>eh(!1)})]})}function p(e){let{gameId:t,onAdvanced:a}=e,[r,l]=(0,s.useState)(4),[i,o]=(0,s.useState)(!1),[c,u]=(0,s.useState)(null),m=(0,s.useCallback)(async()=>{if(!t){u("GameId manquant");return}o(!0),u(null);try{let e=Math.max(1,Math.min(520,r)),n=await (0,d.SC)("/api/games/".concat(t,"/advance-weeks?weeks=").concat(e),{method:"POST"});u("Avanc\xe9 de ".concat(n.weeksApplied," semaines en ").concat(n.durationMs,"ms.")),a&&a()}catch(e){u((null==e?void 0:e.message)||"\xc9chec avance")}finally{o(!1)}},[t,r,a]);return(0,n.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-neutral-400",children:"Avancer le temps de jeu (ticks hebdomadaires). 1h serveur = 1 semaine simul\xe9e."}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("input",{type:"number",min:1,max:520,value:r,onChange:e=>l(Number(e.target.value)||1),className:"w-20 px-2 py-1 rounded bg-neutral-800 border border-neutral-700 text-sm"}),(0,n.jsx)("button",{disabled:i,onClick:m,className:"px-3 py-1.5 rounded bg-purple-700 hover:bg-purple-600 disabled:opacity-50 text-sm",children:i?"Avance…":"Avancer ".concat(r," semaine").concat(r>1?"s":"")})]}),c&&(0,n.jsx)("p",{className:"text-xs text-neutral-300",children:c})]})}function g(){let e=new Date("2025-12-31T23:00:00-05:00"),[t,a]=(0,s.useState)(()=>new Date);if((0,s.useEffect)(()=>{let e=setInterval(()=>a(new Date),6e4);return()=>clearInterval(e)},[]),t>e)return null;let l=Math.max(0,Math.floor((e.getTime()-t.getTime())/864e5));return(0,n.jsxs)("div",{className:"rounded-lg border border-amber-600 bg-gradient-to-r from-amber-700/60 to-yellow-700/50 p-3 flex flex-col md:flex-row md:items-center md:justify-between gap-2 shadow",children:[(0,n.jsx)("div",{className:"text-sm md:text-base font-semibold text-amber-100 flex items-center gap-2",children:(0,n.jsx)("span",{children:"\uD83C\uDFC6 Prix sp\xe9cial: Carte cadeau Amazon 20$ attribu\xe9e le 31 d\xe9cembre 2025 au joueur #1 (valeur nette)."})}),(0,n.jsxs)("div",{className:"text-xs text-amber-200 flex items-center gap-3",children:[(0,n.jsxs)("span",{children:["Compte \xe0 rebours: ",l," jour",1!==l?"s":""]}),(0,n.jsx)(r.default,{href:"/quiz",className:"px-3 py-1 rounded bg-amber-500 hover:bg-amber-400 text-black font-medium text-xs",children:"Booster ton net"})]})]})}},1468:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return l}});var n=a(7821),r=a(8078);function l(e){let{onClose:t,storageKey:a="hm-tutorial-home"}=e,l=[{title:"Objectif Global",content:"Fais cro\xeetre ta valeur nette en combinant 4 moteurs: Immobilier (cashflow & appr\xe9ciation), Bourse (diversification & dividendes), Quiz (acc\xe9l\xe9rateur de capital), Pari (risque contr\xf4l\xe9). Garde toujours un coussin de liquidit\xe9s pour saisir les opportunit\xe9s et \xe9viter de bloquer ton jeu."},{title:"Immobilier — Achat & Stocks",content:"Dans ‘Immobilier’, choisis un bien (ex: six‑plex, tour 50, tour 100). V\xe9rifie loyer, taux et charges. Les boutons ‘refill’ et ‘+10’ maintiennent l’offre (6‑plex→10, tours50→10, tours100→5). Diversifie entre flux de loyers et valeur pour refinancements futurs."},{title:"Bourse — Positions & Dividendes",content:"Dans ‘Bourse’, s\xe9lectionne un symbole (SP500, TSX, QQQ, TLT, GLD). Les dividendes tombent p\xe9riodiquement et renforcent ton cash. M\xe9lange actifs cycliques (croissance) et d\xe9fensifs (obligations/or) pour lisser la volatilit\xe9 immobili\xe8re."},{title:"Quiz — Session de 10 Questions",content:"Consomme 1 token pour lancer: Q1-2 faciles, Q3-5 moyennes, Q6-10 difficiles. Chaque bonne r\xe9ponse double ta somme de session (5k→10k→20k...). Tu peux encaisser \xe0 tout moment avant une erreur. Cat\xe9gories vari\xe9es (anatomy, finance, g\xe9n\xe9ral). Optimise en s\xe9curisant apr\xe8s une bonne s\xe9rie."},{title:"Pari — 3 D\xe9s \xe0 Risque",content:"Mise (≥5 000$) puis lance 3 d\xe9s: double = x2, triple ou suite = x3, sinon perte de la mise. Ne sur‑expose pas ton capital avant un achat immobilier cl\xe9. Le volet Pari est un acc\xe9l\xe9rateur ponctuel, pas un moteur principal durable."},{title:"Strat\xe9gies Rapides",content:"D\xe9marrage: 1–2 six‑plex + quiz pour booster le cash. Milieu: entr\xe9e en bourse, viser tour 50 pour masse critique. Fin: grandes structures + quiz difficile avec encaissement prudent. Toujours anticiper p\xe9nurie: utiliser refill avant manque de stock."},{title:"D\xe9pannage & V\xe9rifications",content:"Probl\xe8me quiz? V\xe9rifie: tokens >0, endpoint /api/games/<id>/quiz/status = 200 (console r\xe9seau). Proxy /api/* corrige CORS. Besoin d’aide: lien contact dans la page ‘Contact’. Garde tes logs propres avant de reporter un bug."},{title:"Invitations Bonus",content:"Utilise ‘Inviter un ami’ sur l’accueil: quand valid\xe9 tu re\xe7ois 1 000 000$. Profite-en pour cr\xe9er un mini r\xe9seau et comparer vos strat\xe9gies de portefeuille."}],[s,i]=(0,r.useState)(0),[o,c]=(0,r.useState)(!1);return(0,n.jsx)("div",{className:"fixed inset-0 z-[9999] bg-black/70 backdrop-blur-sm flex items-center justify-center p-4",children:(0,n.jsxs)("div",{className:"max-w-xl w-full bg-white rounded-2xl shadow-2xl text-gray-900",children:[(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsx)("div",{className:"text-xl font-bold mb-2",children:l[s].title}),(0,n.jsx)("div",{className:"text-sm text-gray-700 mb-6",children:l[s].content}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("label",{className:"text-xs text-gray-600 flex items-center gap-2 select-none",children:[(0,n.jsx)("input",{type:"checkbox",checked:o,onChange:e=>c(e.target.checked)}),"Ne plus afficher automatiquement"]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[s>0&&(0,n.jsx)("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>i(e=>Math.max(0,e-1)),children:"← Pr\xe9c\xe9dent"}),s<l.length-1?(0,n.jsx)("button",{className:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>i(e=>Math.min(l.length-1,e+1)),children:"Suivant →"}):(0,n.jsx)("button",{className:"px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:function(){try{o&&localStorage.setItem(a,"1")}catch(e){}t()},children:"C’est parti"})]})]})]}),(0,n.jsx)("div",{className:"px-6 pb-4 text-center",children:(0,n.jsx)("div",{className:"inline-flex gap-1",children:l.map((e,t)=>(0,n.jsx)("span",{className:"h-2 w-2 rounded-full ".concat(t===s?"bg-indigo-600":"bg-gray-300")},t))})})]})})}},6325:function(e,t,a){"use strict";a.d(t,{Ie:function(){return x},YY:function(){return o},fL:function(){return m},showInterstitialAd:function(){return u},yk:function(){return h}});let n=!1,r=0,l=0;function s(){var e,t,a;let n=!!(null===(t=window.Capacitor)||void 0===t?void 0:null===(e=t.isNativePlatform)||void 0===e?void 0:e.call(t));return console.log("[Ads] isNativePlatform:",n),console.log("[Ads] Capacitor available:",!!window.Capacitor),console.log("[Ads] Capacitor.isNativePlatform:",null===(a=window.Capacitor)||void 0===a?void 0:a.isNativePlatform),n}function i(){var e;let t=window.Capacitor;return(console.log("[Ads] Capacitor:",t),console.log("[Ads] Capacitor.Plugins:",null==t?void 0:t.Plugins),console.log("[Ads] Capacitor.Plugins.AdMob:",null==t?void 0:null===(e=t.Plugins)||void 0===e?void 0:e.AdMob),null==t?void 0:t.Plugins)?t.Plugins.AdMob:null}async function o(){if(!n&&s()){try{let e=localStorage.getItem("hm-ad-consent");if(!e){let t=i();if(t&&"function"==typeof t.requestConsent)try{let a=await t.requestConsent();if(a&&"boolean"==typeof a.npa){let t=a.npa?"npa":"accepted";try{localStorage.setItem("hm-ad-consent",t),localStorage.setItem("hm-ad-consent-date",new Date().toISOString())}catch(e){}e=t}}catch(e){console.warn("[Ads] Native requestConsent failed:",e)}}if("accepted"!==e&&"npa"!==e){console.log("[Ads] User has not accepted ad consent, skipping initialization");return}}catch(e){}try{let s=i();if(!s){console.log("[Ads] AdMob plugin not available");return}await s.initialize(),n=!0;try{var e,t,a,r,l;null===(e=s.addListener)||void 0===e||e.call(s,"adShowed",()=>console.log("[Ads] Event: adShowed")),null===(t=s.addListener)||void 0===t||t.call(s,"adDismissed",()=>console.log("[Ads] Event: adDismissed")),null===(a=s.addListener)||void 0===a||a.call(s,"rewardedAdShowed",()=>console.log("[Ads] Event: rewardedAdShowed")),null===(r=s.addListener)||void 0===r||r.call(s,"rewardedAdDismissed",()=>console.log("[Ads] Event: rewardedAdDismissed")),null===(l=s.addListener)||void 0===l||l.call(s,"rewardEarned",e=>console.log("[Ads] Event: rewardEarned",e))}catch(e){console.warn("[Ads] Failed to attach listeners:",e)}await c(),await d(),console.log("[Ads] AdMob initialized successfully")}catch(e){console.error("[Ads] Failed to initialize AdMob:",e)}}}async function c(){if(!s())return;let e=i();if(e&&n)try{await e.loadInterstitial(),console.log("[Ads] Interstitial ad loaded")}catch(e){console.error("[Ads] Failed to load interstitial ad:",e)}}async function d(){if(!s())return;let e=i();if(e&&n)try{await e.loadRewardedAd(),console.log("[Ads] Rewarded ad loaded")}catch(e){console.error("[Ads] Failed to load rewarded ad:",e)}}async function u(){if(!s())return console.log("[Ads] Not on native platform"),!1;let e=i();if(!e||!n)return console.log("[Ads] AdMob not initialized"),!1;let t=Date.now();if(t-r<12e4)return console.log("[Ads] Too soon to show another ad"),!1;try{let{ready:a}=await e.isAdReady();if(!a)return console.log("[Ads] No ad ready to show, loading new one..."),c(),!1;return await e.showInterstitial(),r=t,c(),console.log("[Ads] Interstitial ad shown successfully"),!0}catch(e){return console.error("[Ads] Failed to show interstitial ad:",e),!1}}async function m(e){if(!s())return console.log("[Ads] Not on native platform"),!1;let t=i();if(!t||!n)return console.log("[Ads] AdMob not initialized"),!1;let a=Date.now();if(a-l<3e5){let e=Math.ceil((3e5-(a-l))/6e4);return console.log("[Ads] Too soon to show another rewarded ad. Wait ".concat(e," more minutes")),!1}try{let{ready:n}=await t.isRewardedAdReady();if(!n)return console.log("[Ads] No rewarded ad ready to show, loading new one..."),d(),!1;let r=await t.showRewardedAd();return l=a,e&&e(r.amount,r.type),d(),console.log("[Ads] Rewarded ad shown successfully. Reward: ".concat(r.amount," ").concat(r.type)),!0}catch(e){return console.error("[Ads] Failed to show rewarded ad:",e),!1}}async function h(){if(!s())return!1;let e=i();if(!e||!n||Date.now()-l<3e5)return!1;try{let{ready:t}=await e.isRewardedAdReady();return t}catch(e){return!1}}function x(){let e=Date.now()-l;return e>=3e5?0:Math.ceil((3e5-e)/1e3)}},9513:function(e,t,a){"use strict";a.d(t,{MS:function(){return c},SC:function(){return h},Sg:function(){return o}});var n=a(5050);let r="https://server-jeux-millionnaire.onrender.com",l=!!window.Capacitor,s=/localhost:3000$/.test(window.location.host),i="1"===n.env.NEXT_PUBLIC_FORCE_ABS,o=l||i||!s?r:"";console.log("[API] ABS_BACKEND:",r),console.log("[API] isCapacitor:",l),console.log("[API] isLocalDev:",s),console.log("[API] forceAbs:",i),console.log("[API] API_BASE:",o);class c extends Error{constructor(e,t){super(t),this.name="ApiError",this.status=e,Object.setPrototypeOf(this,c.prototype)}}let d=null,u="HM_TOKEN";async function m(){try{var e;if(d)return d;let t=await fetch("".concat(o,"/api/auth/csrf"),{credentials:"include"});if(!t.ok)return null;let a=await t.json();return d=null!==(e=null==a?void 0:a.csrf)&&void 0!==e?e:null}catch(e){return null}}async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=(t.method||"GET").toUpperCase(),n={...t.headers};if(console.log("[API] ".concat(a," ").concat(o).concat(e)),["POST","PUT","PATCH","DELETE"].includes(a)){let e=await m();e&&(n["x-csrf-token"]=e)}let r=function(){try{return window.localStorage.getItem(u)}catch(e){return null}}();r&&(n.Authorization="Bearer ".concat(r));let l=function(){try{let e=window.localStorage.getItem("hm-session");if(!e)return null;return JSON.parse(e).playerId||null}catch(e){return null}}();l&&(n["X-Player-ID"]=l);try{let a=await fetch("".concat(o).concat(e),{credentials:"include",...t,headers:n});if(console.log("[API] Response ".concat(a.status," ").concat(a.statusText)),401===a.status)try{if(r){let a=await fetch("".concat(o,"/api/auth/refresh"),{credentials:"include",headers:{Authorization:"Bearer ".concat(r)}});if(a.ok){let r=await a.json().catch(()=>({}));if(null==r?void 0:r.token){try{window.localStorage.setItem(u,r.token)}catch(e){}n.Authorization="Bearer ".concat(r.token)}let l=await fetch("".concat(o).concat(e),{credentials:"include",...t,headers:n});if(!l.ok)throw new c(l.status,l.statusText);if(204===l.status)return;return await l.json()}}}catch(e){}if(!a.ok)try{if((a.headers.get("content-type")||"").includes("application/json")){let e=await a.json(),t=e&&(e.error||e.message)?String(e.error||e.message):"Erreur ".concat(a.status);throw new c(a.status,t)}{let e=(await a.text()||"").trim(),t=e.length?e:a.statusText?"".concat(a.status," ").concat(a.statusText):"Erreur ".concat(a.status);throw new c(a.status,t)}}catch(t){let e=a.statusText?"".concat(a.status," ").concat(a.statusText):"Erreur ".concat(a.status);if(t instanceof c)throw t;throw new c(a.status,e)}if(204===a.status)return;return await a.json()}catch(e){throw console.error("[API] Fetch error:",e),new c(0,"Erreur r\xe9seau: ".concat(e.message||"Failed to fetch"))}}},2044:function(e,t,a){"use strict";function n(e){let t=Number(e);return isFinite(t)?"$".concat(Math.round(t).toLocaleString()):"$0"}function r(e){return 52*Number(e||0)/12}a.d(t,{P:function(){return r},l:function(){return n}})},2705:function(e,t,a){"use strict";a.d(t,{Aj:function(){return l},Ov:function(){return s},dF:function(){return r}});let n="hm-session";function r(){let e=window;if(!e)return null;try{let t=e.localStorage.getItem(n);if(!t)return null;let a=JSON.parse(t);if(!a.gameId)return null;return a}catch(e){return console.error("loadSession error",e),null}}function l(e){let t=window;t&&t.localStorage.setItem(n,JSON.stringify(e))}function s(){let e=window;e&&e.localStorage.removeItem(n)}},168:function(e,t,a){"use strict";var n=a(7462);a.o(n,"usePathname")&&a.d(t,{usePathname:function(){return n.usePathname}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}})}},function(e){e.O(0,[233,640,115,205,744],function(){return e(e.s=3657)}),_N_E=e.O()}]);