(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1],{3355:function(e,t,a){Promise.resolve().then(a.bind(a,5212))},5212:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return s}});var n=a(7821),o=a(8078),l=a(6325);function s(){var e,t;let[a,s]=(0,o.useState)({native:!1}),[r,d]=(0,o.useState)(!1),i=(0,o.useCallback)(async()=>{let e,t;let a=(0,l.Nf)(),n=null,o=null;try{n=localStorage.getItem("hm-ad-consent"),o=localStorage.getItem("hm-ad-consent-date")}catch(e){}try{e=await (0,l.Fy)()}catch(e){}try{t=await (0,l.yk)({ignoreCooldown:!0})}catch(e){}s(l=>({...l,native:a,adReady:e,rewardedReady:t,consent:n,consentDate:o}))},[]);(0,o.useEffect)(()=>{i()},[i]);let c=e=>s(t=>({...t,lastLog:e})),u=async()=>{d(!0);try{await (0,l.YY)(),c("initializeAds() OK")}catch(e){c("initializeAds() error: ".concat((null==e?void 0:e.message)||e))}finally{d(!1),i()}},h=async()=>{d(!0);try{let e=await (0,l.showInterstitialAd)();c("showInterstitialAd() => ".concat(e))}catch(e){c("showInterstitialAd() error: ".concat((null==e?void 0:e.message)||e))}finally{d(!1),i()}},g=async()=>{d(!0);try{let e=await (0,l.fL)({ignoreCooldown:!0,onReward:(e,t)=>{c("Rewarded: ".concat(e," ").concat(t))}});c("showRewardedAdForReward() => ".concat(e))}catch(e){c("showRewardedAdForReward() error: ".concat((null==e?void 0:e.message)||e))}finally{d(!1),i()}},w=async()=>{d(!0);try{localStorage.removeItem("hm-ad-consent"),localStorage.removeItem("hm-ad-consent-date"),c("Consent reset")}catch(e){c("Reset error: ".concat((null==e?void 0:e.message)||e))}finally{d(!1),i()}},f=async()=>{d(!0);try{localStorage.setItem("hm-ad-consent","npa"),localStorage.setItem("hm-ad-consent-date",new Date().toISOString()),await (0,l.YY)(),c("Consent=NPA & init OK")}catch(e){c("Set NPA error: ".concat((null==e?void 0:e.message)||e))}finally{d(!1),i()}},m=async()=>{d(!0);try{localStorage.setItem("hm-ad-consent","accepted"),localStorage.setItem("hm-ad-consent-date",new Date().toISOString()),await (0,l.YY)(),c("Consent=accepted & init OK")}catch(e){c("Set accepted error: ".concat((null==e?void 0:e.message)||e))}finally{d(!1),i()}};return(0,n.jsxs)("main",{className:"space-y-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold",children:"Debug Ads"}),(0,n.jsxs)("section",{className:"grid gap-3 text-sm text-neutral-300 md:grid-cols-2",children:[(0,n.jsxs)("div",{className:"rounded border border-neutral-800 bg-neutral-900 p-4 space-y-2",children:[(0,n.jsxs)("div",{children:["Native: ",(0,n.jsx)("span",{className:"font-mono",children:String(a.native)})]}),(0,n.jsxs)("div",{children:["Consent: ",(0,n.jsx)("span",{className:"font-mono",children:null!==(e=a.consent)&&void 0!==e?e:"(null)"})]}),(0,n.jsxs)("div",{children:["Date: ",(0,n.jsx)("span",{className:"font-mono",children:a.consentDate?new Date(a.consentDate).toLocaleString():"-"})]}),(0,n.jsxs)("div",{children:["Interstitial ready: ",(0,n.jsx)("span",{className:"font-mono",children:String(a.adReady)})]}),(0,n.jsxs)("div",{children:["Rewarded ready: ",(0,n.jsx)("span",{className:"font-mono",children:String(a.rewardedReady)})]}),(0,n.jsxs)("div",{children:["Last: ",(0,n.jsx)("span",{className:"font-mono",children:null!==(t=a.lastLog)&&void 0!==t?t:"-"})]})]}),(0,n.jsxs)("div",{className:"rounded border border-neutral-800 bg-neutral-900 p-4 space-y-2",children:[(0,n.jsx)("div",{className:"font-medium mb-1",children:"Actions"}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,n.jsx)("button",{onClick:u,disabled:r,className:"px-3 py-2 rounded bg-emerald-600 hover:bg-emerald-500 text-white disabled:opacity-60",children:"Init"}),(0,n.jsx)("button",{onClick:i,disabled:r,className:"px-3 py-2 rounded bg-neutral-700 hover:bg-neutral-600 text-white disabled:opacity-60",children:"Refresh"}),(0,n.jsx)("button",{onClick:h,disabled:r,className:"px-3 py-2 rounded bg-sky-600 hover:bg-sky-500 text-white disabled:opacity-60",children:"Show Interstitial"}),(0,n.jsx)("button",{onClick:g,disabled:r,className:"px-3 py-2 rounded bg-amber-600 hover:bg-amber-500 text-white disabled:opacity-60",children:"Show Rewarded"})]}),(0,n.jsx)("div",{className:"font-medium mt-3 mb-1",children:"Consent"}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,n.jsx)("button",{onClick:m,disabled:r,className:"px-3 py-2 rounded bg-blue-600 hover:bg-blue-500 text-white disabled:opacity-60",children:"Set accepted"}),(0,n.jsx)("button",{onClick:f,disabled:r,className:"px-3 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white disabled:opacity-60",children:"Set NPA"}),(0,n.jsx)("button",{onClick:w,disabled:r,className:"px-3 py-2 rounded bg-neutral-700 hover:bg-neutral-600 text-white disabled:opacity-60",children:"Reset"})]})]})]}),(0,n.jsx)("p",{className:"text-xs text-neutral-400",children:'Astuce: regarde Logcat pour les tags "AdMobPlugin" et les logs "[Ads] ...".'})]})}},6325:function(e,t,a){"use strict";a.d(t,{Fy:function(){return m},Ie:function(){return w},Nf:function(){return f},YY:function(){return d},fL:function(){return h},showInterstitialAd:function(){return u},yk:function(){return g}});let n=!1,o=0,l=0;try{{let e=localStorage.getItem("hm-ads-rewarded-last"),t=e?Number(e):0;!Number.isNaN(t)&&t>0&&(l=t)}}catch(e){}function s(){let e=window.Capacitor,t=!1;try{let a=null==e?void 0:e.isNativePlatform;"function"==typeof a?t=!!a():(null==e?void 0:e.platform)&&"web"!==e.platform&&(t=!0)}catch(e){}return console.log("[Ads] isNativePlatform:",t),console.log("[Ads] Capacitor available:",!!e),console.log("[Ads] Capacitor.platform:",null==e?void 0:e.platform),t}function r(){var e;let t=window.Capacitor;return(console.log("[Ads] Capacitor:",t),console.log("[Ads] Capacitor.Plugins:",null==t?void 0:t.Plugins),console.log("[Ads] Capacitor.Plugins.AdMob:",null==t?void 0:null===(e=t.Plugins)||void 0===e?void 0:e.AdMob),null==t?void 0:t.Plugins)?t.Plugins.AdMob:null}async function d(){if(!n){if(!s()){console.log("[Ads] Skip initialization (web/PWA)");return}try{let e=localStorage.getItem("hm-ad-consent");if(!e||"refused"===e){let t=r();if(t&&"function"==typeof t.requestConsent)try{let a=await t.requestConsent();if(a&&"boolean"==typeof a.npa){let t=a.npa?"npa":"accepted";try{localStorage.setItem("hm-ad-consent",t),localStorage.setItem("hm-ad-consent-date",new Date().toISOString())}catch(e){}e=t}}catch(e){console.warn("[Ads] Native requestConsent failed:",e)}}if("refused"===e){e="npa";try{localStorage.setItem("hm-ad-consent","npa"),localStorage.setItem("hm-ad-consent-date",new Date().toISOString())}catch(e){}}if("accepted"!==e&&"npa"!==e){console.log("[Ads] User has not accepted ad consent, skipping initialization");return}}catch(e){}try{let s=r();if(!s){console.log("[Ads] AdMob plugin not available");return}await s.initialize(),n=!0;try{var e,t,a,o,l;null===(e=s.addListener)||void 0===e||e.call(s,"adShowed",()=>console.log("[Ads] Event: adShowed")),null===(t=s.addListener)||void 0===t||t.call(s,"adDismissed",()=>console.log("[Ads] Event: adDismissed")),null===(a=s.addListener)||void 0===a||a.call(s,"rewardedAdShowed",()=>console.log("[Ads] Event: rewardedAdShowed")),null===(o=s.addListener)||void 0===o||o.call(s,"rewardedAdDismissed",()=>console.log("[Ads] Event: rewardedAdDismissed")),null===(l=s.addListener)||void 0===l||l.call(s,"rewardEarned",e=>console.log("[Ads] Event: rewardEarned",e))}catch(e){console.warn("[Ads] Failed to attach listeners:",e)}await i(),await c(),console.log("[Ads] AdMob initialized successfully")}catch(e){console.error("[Ads] Failed to initialize AdMob:",e)}}}async function i(){if(!s())return;let e=r();if(e&&n)try{await e.loadInterstitial(),console.log("[Ads] Interstitial ad loaded")}catch(e){console.error("[Ads] Failed to load interstitial ad:",e)}}async function c(){if(!s())return;let e=r();if(e&&n)try{await e.loadRewardedAd(),console.log("[Ads] Rewarded ad loaded")}catch(e){console.error("[Ads] Failed to load rewarded ad:",e)}}async function u(){if(!s())return console.log("[Ads] Not on native platform"),!1;let e=r();if(!e||!n)return console.log("[Ads] AdMob not initialized"),!1;let t=Date.now();if(t-o<12e4)return console.log("[Ads] Too soon to show another ad"),!1;try{let{ready:a}=await e.isAdReady();if(!a)return console.log("[Ads] No ad ready to show, loading new one..."),i(),!1;return await e.showInterstitial(),o=t,i(),console.log("[Ads] Interstitial ad shown successfully"),!0}catch(e){return console.error("[Ads] Failed to show interstitial ad:",e),!1}}async function h(e){var t;if(!s())return console.log("[Ads] Not on native platform"),!1;let a=r();if(!a||!n)return console.log("[Ads] AdMob not initialized"),!1;let o="function"==typeof e?{onReward:e}:null!=e?e:{},d=null!==(t=o.ignoreCooldown)&&void 0!==t&&t,i=Date.now();if(!d&&i-l<3e5){let e=Math.ceil((3e5-(i-l))/6e4);return console.log("[Ads] Too soon to show another rewarded ad. Wait ".concat(e," more minutes")),!1}try{let{ready:e}=await a.isRewardedAdReady();if(!e)return console.log("[Ads] No rewarded ad ready to show, loading new one..."),c(),!1;let t=await a.showRewardedAd();if(!d){l=i;try{localStorage.setItem("hm-ads-rewarded-last",String(i))}catch(e){}}return o.onReward&&o.onReward(t.amount,t.type),c(),console.log("[Ads] Rewarded ad shown successfully. Reward: ".concat(t.amount," ").concat(t.type)),!0}catch(e){return console.error("[Ads] Failed to show rewarded ad:",e),!1}}async function g(e){if(!s())return!1;let t=r();if(!t||!n)return!1;let a=Date.now();if(!(null==e?void 0:e.ignoreCooldown)&&a-l<3e5)return!1;try{let{ready:e}=await t.isRewardedAdReady();return e}catch(e){return!1}}function w(){let e=Date.now()-l;return e>=3e5?0:Math.ceil((3e5-e)/1e3)}function f(){return s()}async function m(){if(!s())return!1;let e=r();if(!e||!n)return!1;try{let{ready:t}=await e.isAdReady();return t}catch(e){return!1}}}},function(e){e.O(0,[115,205,744],function(){return e(e.s=3355)}),_N_E=e.O()}]);